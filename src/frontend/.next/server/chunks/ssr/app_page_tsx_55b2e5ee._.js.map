{"version":3,"sources":["../../../../app/page.tsx","../../../../components/cyber-frame.tsx","../../../../lib/data.ts","../../../../components/panels/graph-panel.tsx","../../../../components/panels/events-panel.tsx","../../../../components/panels/agents-panel.tsx","../../../../components/panels/stats-panel.tsx","../../../../components/panels/messages-panel.tsx"],"sourcesContent":["\"use client\"\n\nimport { useEffect, useState } from \"react\"\nimport { CyberFrame, type TabId } from \"@/components/cyber-frame\"\nimport { GraphPanel } from \"@/components/panels/graph-panel\"\nimport { EventsPanel } from \"@/components/panels/events-panel\"\nimport { AgentsPanel } from \"@/components/panels/agents-panel\"\nimport { StatsPanel } from \"@/components/panels/stats-panel\"\nimport { MessagesPanel } from \"@/components/panels/messages-panel\"\nimport { addEvent, getWorldTime, setWorldTimeSpeed } from \"@/lib/data\"\nexport default function Home() {\n  const [activeTab, setActiveTab] = useState<TabId>(\"graph\")\n  const [timeSpeed, setTimeSpeed] = useState(1)\n  const [worldTime, setWorldTime] = useState<string | null>(null)\n  const [selectedAgentId, setSelectedAgentId] = useState<string | null>(null)\n  const [sourceTab, setSourceTab] = useState<TabId | null>(null)\n  const [refreshToken, setRefreshToken] = useState(0)\n\n  useEffect(() => {\n    let active = true\n\n    const syncWorldTime = async () => {\n      const current = await getWorldTime()\n      if (!current || !active) {\n        return\n      }\n\n      setTimeSpeed((prev) => (Math.abs(prev - current.speed) > 0.001 ? current.speed : prev))\n      setWorldTime((prev) => {\n        if (!prev) {\n          return current.gameTime\n        }\n\n        const prevMs = new Date(prev).getTime()\n        const nextMs = new Date(current.gameTime).getTime()\n        if (!Number.isFinite(prevMs) || !Number.isFinite(nextMs)) {\n          return current.gameTime\n        }\n\n        // Keep UI smooth: resync only if drift exceeds one in-game minute.\n        return Math.abs(nextMs - prevMs) >= 60_000 ? current.gameTime : prev\n      })\n    }\n\n    void syncWorldTime()\n    const timer = setInterval(syncWorldTime, 5000)\n    return () => {\n      active = false\n      clearInterval(timer)\n    }\n  }, [])\n\r\n  const handleAddEvent = async (text: string) => {\n    const saved = await addEvent(text)\n    if (!saved) {\n      console.warn(\"[ui] Event was not sent to backend, fallback mode is active\")\n      return\n    }\n\n    setRefreshToken((prev) => prev + 1)\n  }\n\n  const handleTimeSpeedChange = async (speed: number) => {\n    setTimeSpeed(speed)\n    const updated = await setWorldTimeSpeed(speed)\n    if (!updated) {\n      return\n    }\n\n    setTimeSpeed(updated.speed)\n    setWorldTime(updated.gameTime)\n    setRefreshToken((prev) => prev + 1)\n  }\n\r\n  const handleSelectAgentFromGraph = (agentId: string) => {\n    setSelectedAgentId(agentId)\n    setSourceTab(\"graph\")\n    setActiveTab(\"agents\")\n  }\n\n  const handleTabChange = (tab: TabId) => {\n    setActiveTab(tab)\n    if (tab !== \"agents\") {\n      setSelectedAgentId(null)\n      setSourceTab(null)\r\n    }\r\n  }\r\n\r\n  function renderContent() {\r\n    switch (activeTab) {\r\n      case \"graph\":\n        return <GraphPanel onSelectAgent={handleSelectAgentFromGraph} refreshToken={refreshToken} />\n      case \"events\":\n        return <EventsPanel refreshToken={refreshToken} />\n      case \"stats\":\n        return <StatsPanel refreshToken={refreshToken} />\n      case \"agents\":\n        return (\n          <AgentsPanel\n            refreshToken={refreshToken}\n            preSelectedAgentId={selectedAgentId}\n            onClearSelection={() => {\n              setSelectedAgentId(null)\n              if (sourceTab === \"graph\") {\n                setActiveTab(\"graph\")\n                setSourceTab(null)\n              }\r\n            }}\r\n            fromGraph={sourceTab === \"graph\"}\r\n          />\r\n        )\r\n      case \"messages\":\r\n        return <MessagesPanel />\r\n      default:\r\n        return null\r\n    }\r\n  }\r\n\r\n  return (\r\n    <CyberFrame\r\n      activeTab={activeTab}\r\n      onTabChange={handleTabChange}\r\n      onAddEvent={handleAddEvent}\n      timeSpeed={timeSpeed}\n      onTimeSpeedChange={handleTimeSpeedChange}\n      worldTime={worldTime}\n    >\n      {renderContent()}\n    </CyberFrame>\n  )\n}\n\r\n","\"use client\"\r\n\r\nimport { useEffect, useRef, useState } from \"react\"\n\r\nconst TABS = [\r\n  { id: \"graph\", label: \"ГРАФ\" },\r\n  { id: \"events\", label: \"СОБЫТИЯ\" },\r\n  { id: \"stats\", label: \"СТАТИСТИКА\" },\r\n  { id: \"agents\", label: \"АГЕНТЫ\" },\r\n  { id: \"messages\", label: \"СООБЩЕНИЯ\" },\r\n] as const\r\n\r\nexport type TabId = (typeof TABS)[number][\"id\"]\r\n\r\nconst DEFAULT_SPEED = 1\r\n\r\nexport function CyberFrame({\r\n  children,\r\n  activeTab = \"graph\",\r\n  onTabChange,\r\n  onAddEvent,\r\n  timeSpeed = 1,\r\n  onTimeSpeedChange,\r\n  worldTime,\r\n}: {\r\n  children: React.ReactNode\r\n  activeTab?: TabId\r\n  onTabChange?: (tab: TabId) => void\r\n  onAddEvent?: (text: string) => void\r\n  timeSpeed?: number\r\n  onTimeSpeedChange?: (speed: number) => void\r\n  worldTime?: string | null\r\n}) {\r\n  const [time, setTime] = useState(\"--:--:--\")\r\n  const [date, setDate] = useState(\"--.--.----\")\r\n  const [eventText, setEventText] = useState(\"\")\n  const [speedHover, setSpeedHover] = useState(false)\n  const [mounted, setMounted] = useState(false)\n  const lastNonZeroSpeedRef = useRef(DEFAULT_SPEED)\n\n  const isPaused = timeSpeed <= 0.001\n\n  useEffect(() => {\n    if (timeSpeed > 0.001) {\n      lastNonZeroSpeedRef.current = timeSpeed\n    }\n  }, [timeSpeed])\n\r\n  useEffect(() => {\r\n    setMounted(true)\r\n  }, [])\r\n\r\n  useEffect(() => {\r\n    if (!worldTime) {\r\n      setTime(\"--:--:--\")\r\n      setDate(\"--.--.----\")\r\n      return\r\n    }\r\n\r\n    const base = new Date(worldTime)\r\n    if (Number.isNaN(base.getTime())) {\r\n      setTime(\"--:--:--\")\r\n      setDate(\"--.--.----\")\r\n      return\r\n    }\r\n\r\n    let virtualTimeMs = base.getTime()\r\n    const speed = Math.max(0, timeSpeed)\r\n\r\n    const tick = () => {\r\n      const current = new Date(virtualTimeMs)\r\n      setTime(\r\n        current.toLocaleTimeString(\"ru-RU\", {\r\n          hour: \"2-digit\",\r\n          minute: \"2-digit\",\r\n          second: \"2-digit\",\r\n        })\r\n      )\r\n      setDate(\r\n        current.toLocaleDateString(\"ru-RU\", {\r\n          day: \"2-digit\",\r\n          month: \"2-digit\",\r\n          year: \"numeric\",\r\n        })\r\n      )\r\n\r\n      // 1.0x = 1 in-game minute per real second.\r\n      virtualTimeMs += 1000 * speed * 60\r\n    }\r\n\r\n    tick()\r\n    const id = setInterval(tick, 1000)\r\n    return () => clearInterval(id)\r\n  }, [worldTime, timeSpeed])\r\n\r\n  const handleSubmitEvent = () => {\n    if (eventText.trim() && onAddEvent) {\n      onAddEvent(eventText.trim())\n      setEventText(\"\")\n    }\n  }\n\n  const handleTogglePause = () => {\n    if (!onTimeSpeedChange) {\n      return\n    }\n\n    if (isPaused) {\n      onTimeSpeedChange(Math.max(lastNonZeroSpeedRef.current, DEFAULT_SPEED))\n      return\n    }\n\n    onTimeSpeedChange(0)\n  }\n\r\n  /* percentage-based paddings: 1.2% top/bottom, 1.5% sides -- scales with any screen */\r\n  const framePad = {\r\n    padding: \"1.2% 1.8%\",\r\n  }\r\n\r\n  return (\r\n    <div\r\n      className=\"relative w-screen overflow-hidden flex flex-col\"\r\n      style={{ height: \"100dvh\", backgroundColor: \"var(--background)\" }}\r\n    >\r\n      {/* Scanline overlay */}\r\n      <div\r\n        className=\"pointer-events-none absolute inset-0 z-50\"\r\n        style={{\r\n          background:\r\n            \"repeating-linear-gradient(0deg, transparent, transparent 2px, rgba(229,195,75,0.008) 2px, rgba(229,195,75,0.008) 4px)\",\r\n        }}\r\n      />\r\n\r\n      {/* ========== SVG frame (desktop) ========== */}\r\n      <svg\r\n        className=\"pointer-events-none absolute inset-0 z-40 hidden md:block\"\r\n        style={{ width: \"100%\", height: \"100%\" }}\r\n        viewBox=\"0 0 1000 1000\"\r\n        preserveAspectRatio=\"none\"\r\n        fill=\"none\"\r\n      >\r\n        <defs>\r\n          <filter id=\"glow\">\r\n            <feGaussianBlur stdDeviation=\"2\" result=\"blur\" />\r\n            <feMerge>\r\n              <feMergeNode in=\"blur\" />\r\n              <feMergeNode in=\"SourceGraphic\" />\r\n            </feMerge>\r\n          </filter>\r\n          <filter id=\"glow-strong\">\r\n            <feGaussianBlur stdDeviation=\"4\" result=\"blur\" />\r\n            <feMerge>\r\n              <feMergeNode in=\"blur\" />\r\n              <feMergeNode in=\"SourceGraphic\" />\r\n            </feMerge>\r\n          </filter>\r\n        </defs>\r\n\r\n        {/* Main border */}\r\n        <path\r\n          d=\"M 30 6 L 970 6 L 994 30 L 994 970 L 970 994 L 30 994 L 6 970 L 6 30 Z\"\r\n          stroke=\"var(--cyber-glow)\"\r\n          strokeWidth=\"1.2\"\r\n          filter=\"url(#glow)\"\r\n          opacity=\"0.8\"\r\n        />\r\n        {/* Inner border */}\r\n        <path\r\n          d=\"M 34 10 L 966 10 L 990 34 L 990 966 L 966 990 L 34 990 L 10 966 L 10 34 Z\"\r\n          stroke=\"var(--cyber-glow)\"\r\n          strokeWidth=\"0.3\"\r\n          opacity=\"0.25\"\r\n        />\r\n        {/* Corner accents */}\r\n        <path d=\"M 6 55 L 6 30 L 30 6\" stroke=\"var(--cyber-glow)\" strokeWidth=\"2\" filter=\"url(#glow-strong)\" strokeLinecap=\"square\" />\r\n        <path d=\"M 970 6 L 994 30 L 994 55\" stroke=\"var(--cyber-glow)\" strokeWidth=\"2\" filter=\"url(#glow-strong)\" strokeLinecap=\"square\" />\r\n        <path d=\"M 994 945 L 994 970 L 970 994\" stroke=\"var(--cyber-glow)\" strokeWidth=\"2\" filter=\"url(#glow-strong)\" strokeLinecap=\"square\" />\r\n        <path d=\"M 30 994 L 6 970 L 6 945\" stroke=\"var(--cyber-glow)\" strokeWidth=\"2\" filter=\"url(#glow-strong)\" strokeLinecap=\"square\" />\r\n        {/* Tick marks */}\r\n        {[150, 300, 500, 700, 850].map((x) => (\r\n          <line key={x} x1={x} y1={6} x2={x} y2={12} stroke=\"var(--cyber-glow)\" strokeWidth=\"0.5\" opacity=\"0.35\" />\r\n        ))}\r\n      </svg>\r\n\r\n      {/* Mobile border */}\r\n      <div\r\n        className=\"pointer-events-none absolute inset-[2px] z-40 md:hidden\"\r\n        style={{\r\n          border: \"1px solid var(--cyber-glow)\",\r\n          boxShadow: \"0 0 6px var(--cyber-glow-dim), inset 0 0 6px var(--cyber-glow-dim)\",\r\n          opacity: 0.5,\r\n        }}\r\n      />\r\n\r\n      {/* Side indicators */}\r\n      <div className=\"absolute left-[0.35%] top-1/2 z-40 -translate-y-1/2 flex-col gap-1 hidden lg:flex\">\r\n        {[0.9, 0.7, 0.5, 0.3].map((opacity, i) => (\r\n          <div\r\n            key={i}\r\n            className=\"rounded-sm\"\r\n            style={{\r\n              width: \"3px\",\r\n              height: \"14px\",\r\n              backgroundColor: \"var(--cyber-glow)\",\r\n              opacity,\r\n              boxShadow: \"0 0 4px var(--cyber-glow-dim)\",\r\n            }}\r\n          />\r\n        ))}\r\n      </div>\r\n      <div className=\"absolute right-[0.35%] top-1/2 z-40 -translate-y-1/2 flex-col gap-1 hidden lg:flex\">\r\n        {[0.3, 0.5, 0.7, 0.9].map((opacity, i) => (\r\n          <div\r\n            key={i}\r\n            className=\"rounded-sm\"\r\n            style={{\r\n              width: \"3px\",\r\n              height: \"14px\",\r\n              backgroundColor: \"var(--cyber-glow)\",\r\n              opacity,\r\n              boxShadow: \"0 0 4px var(--cyber-glow-dim)\",\r\n            }}\r\n          />\r\n        ))}\r\n      </div>\r\n\r\n      {/* ============================================= */}\r\n      {/* MAIN CONTENT -- percentage-based spacing      */}\r\n      {/* ============================================= */}\r\n      <div className=\"relative z-10 flex flex-col h-full\" style={framePad}>\r\n\r\n        {/* -------- HEADER -------- */}\r\n        <header className=\"shrink-0 flex flex-col gap-2 pb-[0.6%]\">\r\n          {/* Title row */}\r\n          <div className=\"flex items-center justify-between\">\r\n            <div className=\"flex items-center gap-4 pl-[1.5%]\">\r\n              <h1\r\n                className=\"font-mono text-base md:text-lg lg:text-xl tracking-[0.2em] uppercase whitespace-nowrap\"\r\n                style={{ color: \"var(--cyber-glow)\" }}\r\n              >\r\n                LONG LIVE MODELS\r\n              </h1>\r\n              <div className=\"flex flex-col items-start gap-1\">\n                <button\n                  onClick={handleTogglePause}\n                  className=\"font-mono text-[10px] md:text-xs tracking-wider uppercase cursor-pointer\"\n                  style={{\n                    color: isPaused ? \"#4ade80\" : \"#f87171\",\n                    border: `1px solid ${isPaused ? \"rgba(74,222,128,0.45)\" : \"rgba(248,113,113,0.45)\"}`,\n                    backgroundColor: isPaused ? \"rgba(74,222,128,0.12)\" : \"rgba(248,113,113,0.12)\",\n                    padding: \"2px 8px\",\n                    transition: \"all 0.2s ease\",\n                  }}\n                  title={isPaused ? \"Продолжить течение игрового времени\" : \"Остановить течение игрового времени\"}\n                >\n                  {isPaused ? \"ПРОДОЛЖИТЬ ВРЕМЯ\" : \"ОСТАНОВИТЬ ВРЕМЯ\"}\n                </button>\n\n                <span\n                  className=\"font-mono text-xs md:text-sm tabular-nums whitespace-nowrap\"\n                  style={{ color: \"var(--cyber-glow)\", opacity: 0.5 }}\n                >\n                  {date}\n                  <span className=\"mx-1.5\" style={{ opacity: 0.4 }}>{\"/\"}</span>\n                  {time}\n                </span>\n              </div>\n            </div>\n          </div>\n\r\n          {/* Nav row */}\r\n          <div className=\"flex items-center justify-between\">\r\n            <nav className=\"flex items-center pl-[1.5%]\">\r\n              {TABS.map((tab) => {\r\n                const isActive = activeTab === tab.id\r\n                return (\r\n                  <button\r\n                    key={tab.id}\r\n                    onClick={() => onTabChange?.(tab.id)}\r\n                    className=\"font-mono text-sm md:text-base tracking-wider uppercase cursor-pointer whitespace-nowrap\"\r\n                    style={{\r\n                      padding: \"6px 14px\",\r\n                      color: isActive ? \"var(--cyber-glow)\" : \"var(--muted-foreground)\",\r\n                      backgroundColor: isActive ? \"rgba(229,195,75,0.1)\" : \"transparent\",\r\n                      borderBottom: isActive ? \"2px solid var(--cyber-glow)\" : \"2px solid transparent\",\r\n                      textShadow: isActive ? \"0 0 10px rgba(229,195,75,0.4)\" : \"none\",\r\n                      transition: \"all 0.2s ease\",\r\n                    }}\r\n                    onMouseEnter={(e) => {\r\n                      if (!isActive) {\r\n                        e.currentTarget.style.color = \"var(--cyber-glow)\"\r\n                        e.currentTarget.style.backgroundColor = \"rgba(229,195,75,0.06)\"\r\n                        e.currentTarget.style.textShadow = \"0 0 10px rgba(229,195,75,0.3)\"\r\n                        e.currentTarget.style.borderBottom = \"2px solid rgba(229,195,75,0.4)\"\r\n                      }\r\n                    }}\r\n                    onMouseLeave={(e) => {\r\n                      if (!isActive) {\r\n                        e.currentTarget.style.color = \"var(--muted-foreground)\"\r\n                        e.currentTarget.style.backgroundColor = \"transparent\"\r\n                        e.currentTarget.style.textShadow = \"none\"\r\n                        e.currentTarget.style.borderBottom = \"2px solid transparent\"\r\n                      }\r\n                    }}\r\n                  >\r\n                    {tab.label}\r\n                  </button>\r\n                )\r\n              })}\r\n            </nav>\r\n\r\n            {/* Speed control */}\r\n            <div\r\n              className=\"relative flex items-center gap-3 shrink-0\"\r\n              style={{\r\n                padding: \"5px 14px\",\r\n                backgroundColor: \"rgba(229,195,75,0.04)\",\r\n                border: \"1px solid rgba(229,195,75,0.1)\",\r\n                clipPath: \"polygon(4px 0, calc(100% - 4px) 0, 100% 4px, 100% calc(100% - 4px), calc(100% - 4px) 100%, 4px 100%, 0 calc(100% - 4px), 0 4px)\",\r\n              }}\r\n              onMouseEnter={() => setSpeedHover(true)}\r\n              onMouseLeave={() => setSpeedHover(false)}\r\n            >\r\n              <span\r\n                className=\"font-mono text-xs tracking-widest uppercase select-none\"\r\n                style={{ color: \"var(--muted-foreground)\" }}\r\n              >\r\n                {\"СКОРОСТЬ\"}\r\n              </span>\r\n\r\n              <input\r\n                type=\"range\"\r\n                min={0}\r\n                max={5}\r\n                step={0.1}\r\n                value={timeSpeed}\r\n                onChange={(e) => onTimeSpeedChange?.(Math.round(parseFloat(e.target.value) * 10) / 10)}\r\n                className=\"cyber-slider h-1\"\r\n                style={{\r\n                  width: \"clamp(80px, 8vw, 160px)\",\r\n                  background: `linear-gradient(to right, var(--cyber-glow) ${(timeSpeed / 5) * 100}%, var(--border) ${(timeSpeed / 5) * 100}%)`,\r\n                }}\r\n              />\r\n\r\n              <button\r\n                onClick={() => onTimeSpeedChange?.(DEFAULT_SPEED)}\r\n                className=\"font-mono text-sm tabular-nums cursor-pointer\"\r\n                title={mounted ? `Клик = сброс на ${DEFAULT_SPEED}x` : undefined}\r\n                style={{\r\n                  color: \"var(--cyber-glow)\",\r\n                  textShadow: timeSpeed > 0 ? \"0 0 8px rgba(229,195,75,0.4)\" : \"none\",\r\n                  background: \"none\",\r\n                  border: \"none\",\r\n                  padding: 0,\r\n                  width: \"3.5em\",\r\n                  textAlign: \"right\",\r\n                  transition: \"opacity 0.2s ease, text-shadow 0.2s ease\",\r\n                  opacity: timeSpeed === DEFAULT_SPEED ? 0.7 : 1,\r\n                }}\r\n                onMouseEnter={(e) => {\r\n                  e.currentTarget.style.textShadow = \"0 0 14px rgba(229,195,75,0.7)\"\r\n                }}\r\n                onMouseLeave={(e) => {\r\n                  e.currentTarget.style.textShadow = timeSpeed > 0 ? \"0 0 8px rgba(229,195,75,0.4)\" : \"none\"\r\n                }}\r\n              >\r\n                {timeSpeed.toFixed(1)}x\r\n              </button>\r\n\r\n              {speedHover && (\r\n                <div\r\n                  className=\"absolute top-full right-0 mt-2 px-3 py-1.5 font-mono text-[10px] tracking-wide whitespace-nowrap pointer-events-none z-50 hidden lg:block\"\r\n                  style={{\r\n                    backgroundColor: \"rgba(17,17,24,0.95)\",\r\n                    border: \"1px solid rgba(229,195,75,0.25)\",\r\n                    color: \"var(--cyber-glow)\",\r\n                    clipPath: \"polygon(4px 0, calc(100% - 4px) 0, 100% 4px, 100% calc(100% - 4px), calc(100% - 4px) 100%, 4px 100%, 0 calc(100% - 4px), 0 4px)\",\r\n                  }}\r\n                >\r\n                  {\"Скорость течения времени мира // Клик на значение = сброс\"}\r\n                </div>\r\n              )}\r\n            </div>\r\n          </div>\r\n        </header>\r\n\r\n        {/* -------- CONTENT -------- */}\r\n        <div\r\n          className=\"relative flex-1 min-h-0 overflow-hidden rounded-sm border\"\r\n          style={{ borderColor: \"rgba(229,195,75,0.2)\" }}\r\n        >\r\n          {children}\r\n        </div>\r\n\r\n        {/* -------- BOTTOM PANEL -------- */}\r\n        <div className=\"shrink-0\" style={{ paddingTop: \"0.6%\" }}>\r\n          <div\r\n            className=\"relative overflow-hidden\"\r\n            style={{\r\n              clipPath: \"polygon(8px 0, calc(100% - 8px) 0, 100% 8px, 100% calc(100% - 8px), calc(100% - 8px) 100%, 8px 100%, 0 calc(100% - 8px), 0 8px)\",\r\n            }}\r\n          >\r\n            <div\r\n              className=\"flex items-center gap-3\"\r\n              style={{\r\n                padding: \"4px 6px\",\r\n                border: \"1px solid rgba(229,195,75,0.2)\",\r\n                backgroundColor: \"rgba(17,17,24,0.9)\",\r\n                animation: \"cyber-shimmer 4s ease-in-out infinite\",\r\n                clipPath: \"polygon(8px 0, calc(100% - 8px) 0, 100% 8px, 100% calc(100% - 8px), calc(100% - 8px) 100%, 8px 100%, 0 calc(100% - 8px), 0 8px)\",\r\n              }}\r\n            >\r\n              {/* Pulsing dot */}\r\n              <div className=\"shrink-0 pl-2\">\r\n                <div\r\n                  className=\"h-2 w-2 rounded-full\"\r\n                  style={{\r\n                    backgroundColor: \"var(--cyber-glow)\",\r\n                    boxShadow: \"0 0 6px var(--cyber-glow-dim)\",\r\n                    animation: \"cyber-pulse 2s ease-in-out infinite\",\r\n                  }}\r\n                />\r\n              </div>\r\n\r\n              <input\r\n                type=\"text\"\r\n                value={eventText}\r\n                onChange={(e) => setEventText(e.target.value)}\r\n                onKeyDown={(e) => {\r\n                  if (e.key === \"Enter\") {\r\n                    e.preventDefault()\r\n                    handleSubmitEvent()\r\n                  }\r\n                }}\r\n                placeholder=\"Введите событие для мира агентов...\"\r\n                className=\"flex-1 bg-transparent font-mono text-sm md:text-base py-2.5 placeholder:opacity-30 focus:outline-none\"\r\n                style={{\r\n                  color: \"var(--foreground)\",\r\n                  caretColor: \"var(--cyber-glow)\",\r\n                  paddingLeft: \"8px\",\r\n                  paddingRight: \"8px\",\r\n                }}\r\n              />\r\n\r\n              <button\r\n                onClick={handleSubmitEvent}\r\n                className=\"shrink-0 font-mono text-xs md:text-sm tracking-widest uppercase cursor-pointer\"\r\n                style={{\r\n                  padding: \"10px 20px\",\r\n                  marginRight: \"4px\",\r\n                  backgroundColor: \"rgba(229,195,75,0.08)\",\r\n                  color: \"var(--cyber-glow)\",\r\n                  border: \"1px solid rgba(229,195,75,0.25)\",\r\n                  clipPath: \"polygon(6px 0, calc(100% - 6px) 0, 100% 6px, 100% calc(100% - 6px), calc(100% - 6px) 100%, 6px 100%, 0 calc(100% - 6px), 0 6px)\",\r\n                  transition: \"all 0.25s ease\",\r\n                }}\r\n                onMouseEnter={(e) => {\r\n                  e.currentTarget.style.backgroundColor = \"rgba(229,195,75,0.18)\"\r\n                  e.currentTarget.style.borderColor = \"rgba(229,195,75,0.6)\"\r\n                  e.currentTarget.style.boxShadow = \"0 0 20px rgba(229,195,75,0.15), inset 0 0 12px rgba(229,195,75,0.06)\"\r\n                  e.currentTarget.style.textShadow = \"0 0 10px rgba(229,195,75,0.5)\"\r\n                  e.currentTarget.style.color = \"#f5d96b\"\r\n                }}\r\n                onMouseLeave={(e) => {\r\n                  e.currentTarget.style.backgroundColor = \"rgba(229,195,75,0.08)\"\r\n                  e.currentTarget.style.borderColor = \"rgba(229,195,75,0.25)\"\r\n                  e.currentTarget.style.boxShadow = \"none\"\r\n                  e.currentTarget.style.textShadow = \"none\"\r\n                  e.currentTarget.style.color = \"var(--cyber-glow)\"\r\n                }}\r\n                onMouseDown={(e) => {\r\n                  e.currentTarget.style.backgroundColor = \"rgba(229,195,75,0.3)\"\r\n                  e.currentTarget.style.transform = \"scale(0.97)\"\r\n                }}\r\n                onMouseUp={(e) => {\r\n                  e.currentTarget.style.backgroundColor = \"rgba(229,195,75,0.18)\"\r\n                  e.currentTarget.style.transform = \"scale(1)\"\r\n                }}\r\n              >\r\n                {\"ДОБАВИТЬ СОБЫТИЕ\"}\r\n              </button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n","/**\r\n * Слой данных -- типы и моки.\r\n * Сейчас захардкожено, при подключении БД замени getAgents(), getEvents() и т.д.\r\n * Компоненты трогать не нужно -- зависят только от типов.\r\n */\r\n\r\n// ===== ТИПЫ =====\r\n\r\nexport type Mood = \"happy\" | \"neutral\" | \"sad\" | \"angry\" | \"excited\" | \"anxious\"\r\n\r\nexport interface Agent {\r\n  id: string\r\n  name: string\r\n  avatar: string        // аватар буква/эмо\r\n  mood: Mood\r\n  traits: string[]      // черты\r\n  description: string\r\n  currentPlan: string\r\n  memories: string[]    // воспоминания\r\n}\r\n\r\nexport interface AgentEvent {\r\n  id: string\r\n  agentId: string\r\n  agentName: string\r\n  type: \"chat\" | \"action\" | \"emotion\" | \"system\"\r\n  text: string\r\n  timestamp: string     // ISO\r\n}\r\n\r\nexport interface Relationship {\r\n  from: string          // agent id\r\n  to: string            // agent id\r\n  sentiment: number     // -1 (враг) до 1 (друг)\r\n  label?: string        // \"друзья\", \"враги\", \"знакомые\"\r\n}\r\n\r\nexport interface WorldStats {\r\n  totalEvents: number\r\n  totalConversations: number\r\n  avgMood: number       // 0-1\r\n  mostActiveAgent: string\r\n  topRelationship: { from: string; to: string; sentiment: number }\r\n  eventsByType: { type: string; count: number }[]\r\n  moodDistribution: { mood: Mood; count: number }[]\r\n}\r\n\r\n// ===== НАСТРОЕНИЯ =====\r\n\r\nexport const MOOD_CONFIG: Record<Mood, { color: string; label: string }> = {\r\n  happy:   { color: \"#4ade80\", label: \"Счастлив\" },\r\n  neutral: { color: \"#a0a0b0\", label: \"Нейтрален\" },\r\n  sad:     { color: \"#60a5fa\", label: \"Грустит\" },\r\n  angry:   { color: \"#f87171\", label: \"Злится\" },\r\n  excited: { color: \"#e5c34b\", label: \"Воодушевлён\" },\r\n  anxious: { color: \"#c084fc\", label: \"Тревожится\" },\r\n}\r\n\r\n// ===== МОКСИ =====\r\n\r\nexport const MOCK_AGENTS: Agent[] = [\r\n  {\r\n    id: \"agent-1\",\r\n    name: \"Алексей\",\r\n    avatar: \"А\",\r\n    mood: \"happy\",\r\n    traits: [\"общительный\", \"оптимист\", \"любопытный\"],\r\n    description: \"Молодой исследователь, который всегда ищет новые знакомства. Верит в лучшее в людях.\",\r\n    currentPlan: \"Поговорить с Мариной о вчерашнем событии\",\r\n    memories: [\r\n      \"Встретил Марину на площади\",\r\n      \"Поспорил с Виктором о политике\",\r\n      \"Нашёл старую книгу в библиотеке\",\r\n    ],\r\n  },\r\n  {\r\n    id: \"agent-2\",\r\n    name: \"Марина\",\r\n    avatar: \"М\",\r\n    mood: \"neutral\",\r\n    traits: [\"задумчивая\", \"художница\", \"интроверт\"],\r\n    description: \"Талантливая художница, предпочитает одиночество. Наблюдает за миром через призму искусства.\",\r\n    currentPlan: \"Закончить картину заката\",\r\n    memories: [\r\n      \"Разговор с Алексеем был приятным\",\r\n      \"Виктор показался грубым\",\r\n      \"Увидела красивый закат\",\r\n    ],\r\n  },\r\n  {\r\n    id: \"agent-3\",\r\n    name: \"Виктор\",\r\n    avatar: \"В\",\r\n    mood: \"angry\",\r\n    traits: [\"прямолинейный\", \"амбициозный\", \"упрямый\"],\r\n    description: \"Бывший военный, привык командовать. Не терпит слабости, но глубоко внутри одинок.\",\r\n    currentPlan: \"Доказать свою правоту Алексею\",\r\n    memories: [\r\n      \"Спор с Алексеем закончился ничем\",\r\n      \"Марина отвернулась при встрече\",\r\n      \"Вспомнил службу в армии\",\r\n    ],\r\n  },\r\n  {\r\n    id: \"agent-4\",\r\n    name: \"Елена\",\r\n    avatar: \"Е\",\r\n    mood: \"excited\",\r\n    traits: [\"энергичная\", \"лидер\", \"эмпат\"],\r\n    description: \"Врач по профессии и миротворец по натуре. Старается помирить всех вокруг.\",\r\n    currentPlan: \"Организовать общий ужин для всех\",\r\n    memories: [\r\n      \"Помогла незнакомцу на улице\",\r\n      \"Заметила напряжение между Виктором и Алексеем\",\r\n      \"Получила письмо от старого друга\",\r\n    ],\r\n  },\r\n  {\r\n    id: \"agent-5\",\r\n    name: \"Дмитрий\",\r\n    avatar: \"Д\",\r\n    mood: \"sad\",\r\n    traits: [\"замкнутый\", \"умный\", \"меланхоличный\"],\r\n    description: \"Бывший учёный, потерял лабораторию в пожаре. Живёт на окраине и избегает людей.\",\r\n    currentPlan: \"Попытаться восстановить записи из сгоревшей лаборатории\",\r\n    memories: [\r\n      \"Пожар уничтожил десять лет работы\",\r\n      \"Марина однажды принесла еду\",\r\n      \"Не доверяет Виктору\",\r\n    ],\r\n  },\r\n  {\r\n    id: \"agent-6\",\r\n    name: \"Ольга\",\r\n    avatar: \"О\",\r\n    mood: \"anxious\",\r\n    traits: [\"осторожная\", \"наблюдательная\", \"скрытная\"],\r\n    description: \"Торговка на рынке. Знает все сплетни города, но сама держит много секретов.\",\r\n    currentPlan: \"Разузнать, что случилось на площади вчера ночью\",\r\n    memories: [\r\n      \"Видела Виктора в переулке поздно ночью\",\r\n      \"Елена покупает у неё травы каждую неделю\",\r\n      \"Кто-то следит за ней -- уверена\",\r\n    ],\r\n  },\r\n  {\r\n    id: \"agent-7\",\r\n    name: \"Игорь\",\r\n    avatar: \"И\",\r\n    mood: \"neutral\",\r\n    traits: [\"спокойный\", \"справедливый\", \"старомодный\"],\r\n    description: \"Пожилой сторож библиотеки. Видел многое, говорит мало, но когда говорит -- все слушают.\",\r\n    currentPlan: \"Присматривать за библиотекой и читать хроники\",\r\n    memories: [\r\n      \"Алексей часто приходит читать\",\r\n      \"Помнит, каким был город до войны\",\r\n      \"Не одобряет поведение Виктора\",\r\n    ],\r\n  },\r\n  {\r\n    id: \"agent-8\",\r\n    name: \"Настя\",\r\n    avatar: \"Н\",\r\n    mood: \"happy\",\r\n    traits: [\"жизнерадостная\", \"наивная\", \"творческая\"],\r\n    description: \"Студентка-музыкант, недавно приехала в город. Ещё не знает местных интриг.\",\r\n    currentPlan: \"Найти место для репетиции и познакомиться с людьми\",\r\n    memories: [\r\n      \"Город показался красивым, но странным\",\r\n      \"Марина улыбнулась ей на улице\",\r\n      \"Услышала громкий спор на площади\",\r\n    ],\r\n  },\r\n]\r\n\r\nexport const MOCK_EVENTS: AgentEvent[] = [\r\n  {\r\n    id: \"evt-1\",\r\n    agentId: \"agent-1\",\r\n    agentName: \"Алексей\",\r\n    type: \"chat\",\r\n    text: \"Привет, Марина! Как твоя новая картина?\",\r\n    timestamp: new Date(Date.now() - 300000).toISOString(),\r\n  },\r\n  {\r\n    id: \"evt-2\",\r\n    agentId: \"agent-2\",\r\n    agentName: \"Марина\",\r\n    type: \"emotion\",\r\n    text: \"Почувствовала прилив вдохновения от заката\",\r\n    timestamp: new Date(Date.now() - 240000).toISOString(),\r\n  },\r\n  {\r\n    id: \"evt-3\",\r\n    agentId: \"agent-3\",\r\n    agentName: \"Виктор\",\r\n    type: \"action\",\r\n    text: \"Отправился на площадь, чтобы найти Алексея\",\r\n    timestamp: new Date(Date.now() - 180000).toISOString(),\r\n  },\r\n  {\r\n    id: \"evt-4\",\r\n    agentId: \"agent-4\",\r\n    agentName: \"Елена\",\r\n    type: \"chat\",\r\n    text: \"Виктор, давай поговорим спокойно. Я уверена, вы с Алексеем найдёте общий язык.\",\r\n    timestamp: new Date(Date.now() - 120000).toISOString(),\r\n  },\r\n  {\r\n    id: \"evt-5\",\r\n    agentId: \"agent-3\",\r\n    agentName: \"Виктор\",\r\n    type: \"emotion\",\r\n    text: \"Раздражён: Елена снова лезет не в своё дело\",\r\n    timestamp: new Date(Date.now() - 60000).toISOString(),\r\n  },\r\n  {\r\n    id: \"evt-6\",\r\n    agentId: \"agent-1\",\r\n    agentName: \"Алексей\",\r\n    type: \"action\",\r\n    text: \"Зашёл в библиотеку и нашёл интересную книгу об истории города\",\r\n    timestamp: new Date(Date.now() - 30000).toISOString(),\r\n  },\r\n  {\r\n    id: \"evt-7\",\r\n    agentId: \"agent-2\",\r\n    agentName: \"Марина\",\r\n    type: \"action\",\r\n    text: \"Поставила мольберт у реки и начала рисовать\",\r\n    timestamp: new Date(Date.now() - 15000).toISOString(),\r\n  },\r\n  {\r\n    id: \"evt-8\",\r\n    agentId: \"agent-4\",\r\n    agentName: \"Елена\",\r\n    type: \"system\",\r\n    text: \"Решила организовать общий ужин сегодня вечером\",\r\n    timestamp: new Date(Date.now() - 5000).toISOString(),\r\n  },\r\n  {\r\n    id: \"evt-9\",\r\n    agentId: \"agent-5\",\r\n    agentName: \"Дмитрий\",\r\n    type: \"action\",\r\n    text: \"Нашёл обгоревший дневник среди руин лаборатории\",\r\n    timestamp: new Date(Date.now() - 280000).toISOString(),\r\n  },\r\n  {\r\n    id: \"evt-10\",\r\n    agentId: \"agent-6\",\r\n    agentName: \"Ольга\",\r\n    type: \"emotion\",\r\n    text: \"Тревога нарастает -- кто-то определённо следит\",\r\n    timestamp: new Date(Date.now() - 200000).toISOString(),\r\n  },\r\n  {\r\n    id: \"evt-11\",\r\n    agentId: \"agent-7\",\r\n    agentName: \"Игорь\",\r\n    type: \"action\",\r\n    text: \"Открыл старый архив в подвале библиотеки\",\r\n    timestamp: new Date(Date.now() - 150000).toISOString(),\r\n  },\r\n  {\r\n    id: \"evt-12\",\r\n    agentId: \"agent-8\",\r\n    agentName: \"Настя\",\r\n    type: \"chat\",\r\n    text: \"Простите, вы не подскажете, где тут можно порепетировать?\",\r\n    timestamp: new Date(Date.now() - 90000).toISOString(),\r\n  },\r\n]\r\n\r\nexport const MOCK_RELATIONSHIPS: Relationship[] = [\r\n  // Алексей\r\n  { from: \"agent-1\", to: \"agent-2\", sentiment: 0.7, label: \"дружба\" },\r\n  { from: \"agent-1\", to: \"agent-3\", sentiment: -0.4, label: \"конфликт\" },\r\n  { from: \"agent-1\", to: \"agent-7\", sentiment: 0.4, label: \"уважение\" },\r\n  // Марина\r\n  { from: \"agent-2\", to: \"agent-5\", sentiment: 0.3, label: \"сочувствие\" },\r\n  { from: \"agent-2\", to: \"agent-8\", sentiment: 0.5, label: \"симпатия\" },\r\n  // Виктор\r\n  { from: \"agent-3\", to: \"agent-4\", sentiment: -0.2, label: \"раздражение\" },\r\n  { from: \"agent-3\", to: \"agent-7\", sentiment: -0.3, label: \"неприязнь\" },\r\n  // Елена\r\n  { from: \"agent-4\", to: \"agent-6\", sentiment: 0.4, label: \"торговля\" },\r\n  { from: \"agent-4\", to: \"agent-1\", sentiment: 0.5, label: \"знакомые\" },\r\n  // Ольга\r\n  { from: \"agent-6\", to: \"agent-3\", sentiment: -0.1, label: \"подозрение\" },\r\n  // Игорь -- одиночка, мало связей\r\n  // Настя -- новенькая, только одна связь\r\n  { from: \"agent-8\", to: \"agent-1\", sentiment: 0.2, label: \"знакомые\" },\r\n  // Дмитрий -- затворник, почти нет связей\r\n  { from: \"agent-5\", to: \"agent-7\", sentiment: 0.2, label: \"соседи\" },\r\n]\r\n\r\nexport const MOCK_STATS: WorldStats = {\r\n  totalEvents: 847,\r\n  totalConversations: 234,\r\n  avgMood: 0.62,\r\n  mostActiveAgent: \"Алексей\",\r\n  topRelationship: { from: \"agent-1\", to: \"agent-2\", sentiment: 0.7 },\r\n  eventsByType: [\r\n    { type: \"chat\", count: 312 },\r\n    { type: \"action\", count: 289 },\r\n    { type: \"emotion\", count: 178 },\r\n    { type: \"system\", count: 68 },\r\n  ],\r\n  moodDistribution: [\r\n    { mood: \"happy\", count: 2 },\r\n    { mood: \"neutral\", count: 2 },\r\n    { mood: \"sad\", count: 1 },\r\n    { mood: \"angry\", count: 1 },\r\n    { mood: \"excited\", count: 1 },\r\n    { mood: \"anxious\", count: 1 },\r\n  ],\r\n}\r\n\r\n// ===== ДОСТУП К ДАННЫМ (замени на реальные запросы) =====\r\n\r\ninterface BackendPersonalityTraits {\n  openness?: number\n  conscientiousness?: number\n  extraversion?: number\n  agreeableness?: number\n  neuroticism?: number\n}\n\ninterface BackendAgentDto {\n  agentId: string\n  userId: string\n  name: string\n  model: string\n  status: string\n  state: string\n  energy: number\n  personalityTraits?: BackendPersonalityTraits\n  description?: string\n  emotion?: string\n  traits?: string[]\n  memories?: string[]\n  currentPlan?: string\n}\n\ninterface BackendEventDto {\n  id: string\n  userId?: string\n  type: string\n  payload: unknown\n  createdAt: string\n}\n\ninterface BackendRelationshipDto {\n  from: string\n  to: string\n  sentiment: number\n  label?: string\n}\n\ninterface BackendWorldStatsDto {\n  totalEvents: number\n  totalConversations: number\n  avgMood: number\n  mostActiveAgent: string\n  topRelationship: { from: string; to: string; sentiment: number }\n  eventsByType: { type: string; count: number }[]\n  moodDistribution: { mood: string; count: number }[]\n}\n\ninterface BackendWorldTimeDto {\n  gameTime: string\n  speed: number\n}\n\nconst BACKEND_API_BASE = \"/api/backend\"\nconst DEFAULT_USER_ID = \"demo-user\"\n\nfunction getUserId(): string {\n  const fromEnv = process.env.NEXT_PUBLIC_USER_ID?.trim()\n  return fromEnv && fromEnv.length > 0 ? fromEnv : DEFAULT_USER_ID\n}\n\nasync function backendRequest<T>(path: string, init?: RequestInit): Promise<T> {\n  const headers = new Headers(init?.headers)\n  headers.set(\"Accept\", \"application/json\")\n  headers.set(\"X-User-Id\", getUserId())\n  if (init?.body && !headers.has(\"Content-Type\")) {\n    headers.set(\"Content-Type\", \"application/json\")\n  }\n\n  const response = await fetch(`${BACKEND_API_BASE}${path}`, {\n    ...init,\n    headers,\n    cache: \"no-store\",\n  })\n\n  if (!response.ok) {\n    throw new Error(`Backend request failed: ${response.status} ${response.statusText}`)\n  }\n\n  return (await response.json()) as T\n}\n\nfunction toMood(status: string, energyRaw: number, emotionRaw?: string): Mood {\n  const statusLower = status.toLowerCase()\n  const emotion = emotionRaw?.trim().toLowerCase() ?? \"\"\n  const energy = Number.isFinite(energyRaw) ? Math.max(0, Math.min(1, energyRaw)) : 0.5\n\n  if (emotion.includes(\"радост\") || emotion.includes(\"счаст\") || emotion.includes(\"вдохнов\") || emotion.includes(\"воодуш\")) return \"happy\"\n  if (emotion.includes(\"спокой\") || emotion.includes(\"нейтрал\")) return \"neutral\"\n  if (emotion.includes(\"устал\") || emotion.includes(\"груст\")) return \"sad\"\n  if (emotion.includes(\"раздраж\") || emotion.includes(\"зл\")) return \"angry\"\n  if (emotion.includes(\"тревог\") || emotion.includes(\"напряж\")) return \"anxious\"\n\n  if (statusLower.includes(\"error\") || statusLower.includes(\"failed\")) return \"angry\"\n  if (statusLower.includes(\"stop\") || statusLower.includes(\"archived\")) return \"sad\"\n  if (statusLower.includes(\"pause\")) return \"anxious\"\n  if (energy >= 0.8) return \"excited\"\n  if (energy >= 0.6) return \"happy\"\n  if (energy >= 0.4) return \"neutral\"\n  if (energy >= 0.2) return \"anxious\"\n  return \"sad\"\n}\n\nfunction toTraits(traits?: BackendPersonalityTraits, explicitTraits?: string[]): string[] {\n  if (explicitTraits && explicitTraits.length > 0) {\n    return explicitTraits.slice(0, 8)\n  }\n\n  if (!traits) return [\"adaptive\"]\n\n  const labels: Array<{ key: keyof BackendPersonalityTraits; label: string }> = [\n    { key: \"openness\", label: \"curious\" },\n    { key: \"conscientiousness\", label: \"disciplined\" },\n    { key: \"extraversion\", label: \"social\" },\n    { key: \"agreeableness\", label: \"cooperative\" },\n    { key: \"neuroticism\", label: \"sensitive\" },\n  ]\n\n  const sorted = labels\n    .map((item) => ({ label: item.label, value: Number(traits[item.key] ?? 0) }))\n    .sort((a, b) => b.value - a.value)\n    .filter((item) => item.value > 0)\n    .slice(0, 3)\n    .map((item) => item.label)\n\n  return sorted.length > 0 ? sorted : [\"adaptive\"]\n}\n\nfunction mapBackendAgent(agent: BackendAgentDto): Agent {\n  const mood = toMood(agent.status, agent.energy, agent.emotion)\n  const traits = toTraits(agent.personalityTraits, agent.traits)\n  const memories =\n    agent.memories && agent.memories.length > 0\n      ? agent.memories\n      : agent.state\n        ? [`Current state: ${agent.state}`]\n        : []\n  return {\n    id: agent.agentId,\n    name: agent.name,\n    avatar: agent.name?.trim()?.charAt(0)?.toUpperCase() || \"?\",\n    mood,\n    traits,\n    description: agent.description?.trim() || `${agent.model} - status: ${agent.status}`,\n    currentPlan: agent.currentPlan?.trim() || agent.state || \"No current plan\",\n    memories,\n  }\n}\n\nfunction asRecord(input: unknown): Record<string, unknown> | null {\n  if (!input || typeof input !== \"object\" || Array.isArray(input)) return null\n  return input as Record<string, unknown>\n}\n\nfunction readString(record: Record<string, unknown> | null, keys: string[]): string | undefined {\n  if (!record) return undefined\n  for (const key of keys) {\n    const value = record[key]\n    if (typeof value === \"string\" && value.trim().length > 0) return value.trim()\n  }\n  return undefined\n}\n\nfunction normalizeEventType(rawType: string): AgentEvent[\"type\"] {\n  const t = rawType.toLowerCase()\n  if (t.includes(\"chat\") || t.includes(\"message\")) return \"chat\"\n  if (t.includes(\"emotion\") || t.includes(\"mood\")) return \"emotion\"\n  if (t.includes(\"system\") || t.includes(\"status\") || t.includes(\"error\") || t.includes(\"progress\")) return \"system\"\n  return \"action\"\n}\n\nfunction payloadToText(payload: unknown, eventType: string): string {\n  const record = asRecord(payload)\n  const directText = readString(record, [\"text\", \"message\", \"description\", \"content\"])\n  if (directText) return directText\n  if (record) {\n    const nested = asRecord(record.payload)\n    const nestedText = readString(nested, [\"text\", \"message\", \"description\", \"content\"])\n    if (nestedText) return nestedText\n  }\n\n  try {\n    const json = JSON.stringify(payload)\n    if (!json || json === \"{}\") return eventType\n    return json.slice(0, 200)\n  } catch {\n    return eventType\n  }\n}\n\nfunction mapBackendEvent(event: BackendEventDto, agentsById: Map<string, Agent>): AgentEvent {\n  const record = asRecord(event.payload)\n  const nested = asRecord(record?.payload)\n  const source = nested ?? record\n\n  const agentId =\n    readString(source, [\"agentId\", \"agent_id\", \"id\"]) ??\n    readString(asRecord(source?.agent), [\"id\", \"agentId\"]) ??\n    \"system\"\n\n  const agentName =\n    readString(source, [\"agentName\", \"agent_name\", \"name\"]) ??\n    agentsById.get(agentId)?.name ??\n    \"System\"\n\n  return {\n    id: event.id,\n    agentId,\n    agentName,\n    type: normalizeEventType(event.type),\n    text: payloadToText(event.payload, event.type),\n    timestamp: event.createdAt,\n  }\n}\n\nfunction buildRelationshipsFromEvents(events: AgentEvent[], agents: Agent[]): Relationship[] {\n  const existingIds = new Set(agents.map((a) => a.id))\n  const relCounts = new Map<string, number>()\n\n  for (let i = 1; i < events.length; i += 1) {\n    const previous = events[i - 1]\n    const current = events[i]\n    if (\n      previous.agentId === current.agentId ||\n      previous.agentId === \"system\" ||\n      current.agentId === \"system\" ||\n      !existingIds.has(previous.agentId) ||\n      !existingIds.has(current.agentId)\n    ) {\n      continue\n    }\n\n    const key = `${previous.agentId}|${current.agentId}`\n    relCounts.set(key, (relCounts.get(key) ?? 0) + 1)\n  }\n\n  return Array.from(relCounts.entries())\n    .map(([key, count]) => {\n      const [from, to] = key.split(\"|\")\n      return {\n        from,\n        to,\n        sentiment: Math.min(0.8, count / 5),\n        label: \"interaction\",\n      } satisfies Relationship\n    })\n    .slice(0, 80)\n}\n\nfunction buildStats(agents: Agent[], events: AgentEvent[], relationships: Relationship[]): WorldStats {\n  const moodWeight: Record<Mood, number> = {\n    happy: 0.8,\n    neutral: 0.5,\n    sad: 0.2,\n    angry: 0.15,\n    excited: 0.9,\n    anxious: 0.35,\n  }\n\n  const eventTypeOrder: AgentEvent[\"type\"][] = [\"chat\", \"action\", \"emotion\", \"system\"]\n  const eventsByType = eventTypeOrder.map((type) => ({\n    type,\n    count: events.filter((e) => e.type === type).length,\n  }))\n\n  const moodDistribution = (Object.keys(MOOD_CONFIG) as Mood[]).map((mood) => ({\n    mood,\n    count: agents.filter((a) => a.mood === mood).length,\n  }))\n\n  const avgMood =\n    agents.length === 0\n      ? 0\n      : agents.reduce((sum, agent) => sum + moodWeight[agent.mood], 0) / agents.length\n\n  const activity = new Map<string, number>()\n  for (const event of events) {\n    if (event.agentId !== \"system\") {\n      activity.set(event.agentId, (activity.get(event.agentId) ?? 0) + 1)\n    }\n  }\n\n  const mostActiveAgentId =\n    Array.from(activity.entries()).sort((a, b) => b[1] - a[1])[0]?.[0] ?? agents[0]?.id ?? \"-\"\n  const mostActiveAgent = agents.find((a) => a.id === mostActiveAgentId)?.name ?? mostActiveAgentId\n\n  const topRelationshipRaw = relationships\n    .slice()\n    .sort((a, b) => Math.abs(b.sentiment) - Math.abs(a.sentiment))[0]\n\n  const topRelationship = topRelationshipRaw\n    ? {\n        from: agents.find((a) => a.id === topRelationshipRaw.from)?.name ?? topRelationshipRaw.from,\n        to: agents.find((a) => a.id === topRelationshipRaw.to)?.name ?? topRelationshipRaw.to,\n        sentiment: topRelationshipRaw.sentiment,\n      }\n    : { from: \"-\", to: \"-\", sentiment: 0 }\n\n  return {\n    totalEvents: events.length,\n    totalConversations: eventsByType.find((x) => x.type === \"chat\")?.count ?? 0,\n    avgMood,\n    mostActiveAgent,\n    topRelationship,\n    eventsByType,\n    moodDistribution,\n  }\n}\n\nfunction normalizeMood(rawMood: string): Mood {\n  const mood = rawMood.trim().toLowerCase()\n  if (mood === \"happy\" || mood === \"neutral\" || mood === \"sad\" || mood === \"angry\" || mood === \"excited\" || mood === \"anxious\") {\n    return mood\n  }\n\n  return \"neutral\"\n}\n\nfunction mapBackendStats(stats: BackendWorldStatsDto): WorldStats {\n  return {\n    totalEvents: stats.totalEvents,\n    totalConversations: stats.totalConversations,\n    avgMood: stats.avgMood,\n    mostActiveAgent: stats.mostActiveAgent,\n    topRelationship: stats.topRelationship,\n    eventsByType: stats.eventsByType,\n    moodDistribution: stats.moodDistribution.map((item) => ({\n      mood: normalizeMood(item.mood),\n      count: item.count,\n    })),\n  }\n}\n\nexport interface WorldTime {\n  gameTime: string\n  speed: number\n}\n\nexport async function addEvent(text: string): Promise<boolean> {\n  const payload = {\n    type: \"ui.note\",\n    payload: {\n      text,\n      message: text,\n      source: \"frontend\",\n      agentName: \"Operator\",\n    },\n  }\n\n  try {\n    await backendRequest<unknown>(\"/api/events\", {\n      method: \"POST\",\n      body: JSON.stringify(payload),\n    })\n    return true\n  } catch (error) {\n    console.warn(\"[data] addEvent fallback, backend unavailable\", error)\n    return false\n  }\n}\n\nexport async function generateAgentWithAi(prompt: string, model?: string): Promise<Agent | null> {\n  const trimmedPrompt = prompt.trim()\n  if (!trimmedPrompt) {\n    return null\n  }\n\n  const payload = {\n    prompt: trimmedPrompt,\n    model: model?.trim() || undefined,\n  }\n\n  try {\n    const created = await backendRequest<BackendAgentDto>(\"/api/user-agents/generate\", {\n      method: \"POST\",\n      body: JSON.stringify(payload),\n    })\n\n    return mapBackendAgent(created)\n  } catch (error) {\n    console.warn(\"[data] generateAgentWithAi failed\", error)\n    return null\n  }\n}\n\nexport async function deleteAgent(id: string): Promise<boolean> {\n  const trimmedId = id.trim()\n  if (!trimmedId) {\n    return false\n  }\n\n  try {\n    await backendRequest<unknown>(`/api/user-agents/${encodeURIComponent(trimmedId)}`, {\n      method: \"DELETE\",\n    })\n    return true\n  } catch (error) {\n    console.warn(\"[data] deleteAgent failed\", error)\n    return false\n  }\n}\n\nexport async function getAgents(): Promise<Agent[]> {\n  try {\n    const agents = await backendRequest<BackendAgentDto[]>(\"/api/user-agents\")\n    return agents.map(mapBackendAgent)\n  } catch (error) {\n    console.warn(\"[data] getAgents fallback to mock\", error)\n    return MOCK_AGENTS\n  }\n}\n\nexport async function getAgent(id: string): Promise<Agent | undefined> {\n  try {\n    const agent = await backendRequest<BackendAgentDto>(`/api/user-agents/${encodeURIComponent(id)}`)\n    return mapBackendAgent(agent)\n  } catch {\n    return MOCK_AGENTS.find((a) => a.id === id)\n  }\n}\n\nexport async function getEvents(): Promise<AgentEvent[]> {\n  try {\n    const [agents, events] = await Promise.all([\n      getAgents(),\n      backendRequest<BackendEventDto[]>(\"/api/events\"),\n    ])\n    const agentsById = new Map(agents.map((agent) => [agent.id, agent]))\n    return events.map((event) => mapBackendEvent(event, agentsById))\n  } catch (error) {\n    console.warn(\"[data] getEvents fallback to mock\", error)\n    return MOCK_EVENTS\n  }\n}\n\nexport async function getRelationships(): Promise<Relationship[]> {\n  try {\n    const relationships = await backendRequest<BackendRelationshipDto[]>(\"/api/relationships\")\n    return relationships.map((relationship) => ({\n      from: relationship.from,\n      to: relationship.to,\n      sentiment: relationship.sentiment,\n      label: relationship.label ?? \"interaction\",\n    }))\n  } catch (error) {\n    console.warn(\"[data] getRelationships fallback to mock\", error)\n    return MOCK_RELATIONSHIPS\n  }\n}\n\nexport async function getStats(): Promise<WorldStats> {\n  try {\n    const stats = await backendRequest<BackendWorldStatsDto>(\"/api/stats\")\n    return mapBackendStats(stats)\n  } catch (error) {\n    console.warn(\"[data] getStats fallback to mock\", error)\n    return MOCK_STATS\n  }\n}\n\nexport async function getWorldTime(): Promise<WorldTime | null> {\n  try {\n    const worldTime = await backendRequest<BackendWorldTimeDto>(\"/api/world/time\")\n    return {\n      gameTime: worldTime.gameTime,\n      speed: worldTime.speed,\n    }\n  } catch (error) {\n    console.warn(\"[data] getWorldTime failed\", error)\n    return null\n  }\n}\n\nexport async function setWorldTimeSpeed(speed: number): Promise<WorldTime | null> {\n  try {\n    const updated = await backendRequest<BackendWorldTimeDto>(\"/api/world/time/speed\", {\n      method: \"POST\",\n      body: JSON.stringify({ speed }),\n    })\n    return {\n      gameTime: updated.gameTime,\n      speed: updated.speed,\n    }\n  } catch (error) {\n    console.warn(\"[data] setWorldTimeSpeed failed\", error)\n    return null\n  }\n}\n\nexport async function advanceWorldTime(minutes: number): Promise<WorldTime | null> {\n  try {\n    const updated = await backendRequest<BackendWorldTimeDto>(\"/api/world/time/advance\", {\n      method: \"POST\",\n      body: JSON.stringify({ minutes }),\n    })\n    return {\n      gameTime: updated.gameTime,\n      speed: updated.speed,\n    }\n  } catch (error) {\n    console.warn(\"[data] advanceWorldTime failed\", error)\n    return null\n  }\n}\n\r\n\r\n\r\n","\"use client\"\r\n\r\nimport { useEffect, useRef, useState, useCallback, useMemo } from \"react\"\nimport {\r\n  MOOD_CONFIG,\r\n  getAgents,\r\n  getRelationships,\r\n  type Agent,\r\n  type Relationship,\r\n} from \"@/lib/data\"\r\n\r\n// Типы для графа\r\ninterface GraphNode {\r\n  id: string\r\n  name: string\r\n  avatar: string\r\n  mood: string\r\n  moodColor: string\r\n  val: number\r\n  x?: number\r\n  y?: number\r\n  fx?: number | null\r\n  fy?: number | null\r\n  __dragging?: boolean\r\n}\r\n\r\ninterface GraphLink {\r\n  source: string | GraphNode\r\n  target: string | GraphNode\r\n  sentiment: number\r\n  label?: string\r\n  color: string\r\n}\r\n\r\ninterface GraphData {\r\n  nodes: GraphNode[]\r\n  links: GraphLink[]\r\n}\r\n\r\n// Цвет связи по sentiment\r\nfunction sentimentToColor(s: number): string {\r\n  if (s >= 0.5) return \"#4ade80\"\r\n  if (s >= 0.2) return \"#86efac\"\r\n  if (s > -0.2) return \"#555566\"\r\n  if (s > -0.5) return \"#fca5a5\"\r\n  return \"#f87171\"\r\n}\r\n\r\n// Построить граф из агентов и связей\r\nfunction buildGraphData(agents: Agent[], rels: Relationship[]): GraphData {\n  const agentIds = new Set(agents.map((a) => a.id))\r\n\r\n  const nodes: GraphNode[] = agents.map((a) => ({\r\n    id: a.id,\r\n    name: a.name,\r\n    avatar: a.avatar,\r\n    mood: a.mood,\r\n    moodColor: MOOD_CONFIG[a.mood].color,\r\n    val: 8,\r\n  }))\r\n\r\n  const links: GraphLink[] = rels\r\n    .filter((r) => agentIds.has(r.from) && agentIds.has(r.to))\r\n    .map((r) => ({\r\n      source: r.from,\r\n      target: r.to,\r\n      sentiment: r.sentiment,\r\n      label: r.label,\r\n      color: sentimentToColor(r.sentiment),\r\n    }))\r\n\r\n  return { nodes, links }\n}\n\nfunction mergeGraphData(prev: GraphData, agents: Agent[], rels: Relationship[]): GraphData {\n  const next = buildGraphData(agents, rels)\n  const prevNodesById = new Map(prev.nodes.map((node) => [node.id, node]))\n\n  const mergedNodes = next.nodes.map((node) => {\n    const previous = prevNodesById.get(node.id)\n    if (!previous) {\n      return node\n    }\n\n    return {\n      ...node,\n      x: previous.x,\n      y: previous.y,\n      fx: previous.fx,\n      fy: previous.fy,\n      __dragging: previous.__dragging,\n    }\n  })\n\n  return {\n    nodes: mergedNodes,\n    links: next.links,\n  }\n}\n\r\n// Загрузочный оверлей\r\nfunction LoadingOverlay({ visible }: { visible: boolean }) {\r\n  return (\r\n    <div\r\n      className=\"absolute inset-0 z-30 flex items-center justify-center\"\r\n      style={{\r\n        backgroundColor: \"var(--cyber-surface)\",\r\n        opacity: visible ? 1 : 0,\r\n        pointerEvents: visible ? \"auto\" : \"none\",\r\n        transition: \"opacity 0.6s ease\",\r\n      }}\r\n    >\r\n      <div\r\n        className=\"pointer-events-none absolute inset-0 opacity-10\"\r\n        style={{\r\n          backgroundImage:\r\n            \"linear-gradient(var(--cyber-glow) 1px, transparent 1px), linear-gradient(90deg, var(--cyber-glow) 1px, transparent 1px)\",\r\n          backgroundSize: \"60px 60px\",\r\n        }}\r\n      />\r\n      <div className=\"relative flex flex-col items-center gap-4\">\r\n        <div\r\n          className=\"h-16 w-16 rounded-full border flex items-center justify-center\"\r\n          style={{\r\n            borderColor: \"var(--cyber-glow)\",\r\n            boxShadow: \"0 0 20px var(--cyber-glow-dim), inset 0 0 20px var(--cyber-glow-dim)\",\r\n            animation: \"cyber-pulse 2s ease-in-out infinite\",\r\n          }}\r\n        >\r\n          <svg width=\"28\" height=\"28\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"var(--cyber-glow)\" strokeWidth=\"1.5\">\r\n            <circle cx=\"5\" cy=\"12\" r=\"2\" />\r\n            <circle cx=\"19\" cy=\"6\" r=\"2\" />\r\n            <circle cx=\"19\" cy=\"18\" r=\"2\" />\r\n            <line x1=\"7\" y1=\"12\" x2=\"17\" y2=\"6\" />\r\n            <line x1=\"7\" y1=\"12\" x2=\"17\" y2=\"18\" />\r\n          </svg>\r\n        </div>\r\n        <p className=\"font-mono text-sm tracking-[0.2em] uppercase\" style={{ color: \"var(--cyber-glow)\", opacity: 0.6 }}>\r\n          {\"ЗАГРУЗКА ГРАФА\"}\r\n        </p>\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n\r\n// Легенда\r\nfunction Legend() {\r\n  const items = [\r\n    { color: \"#4ade80\", label: \"Дружба\" },\r\n    { color: \"#555566\", label: \"Нейтрально\" },\r\n    { color: \"#f87171\", label: \"Конфликт\" },\r\n  ]\r\n  return (\r\n    <div\r\n      className=\"absolute bottom-3 left-3 z-20 flex items-center gap-4 px-3 py-2 font-mono text-[11px]\"\r\n      style={{\r\n        backgroundColor: \"rgba(10,10,15,0.85)\",\r\n        border: \"1px solid rgba(229,195,75,0.15)\",\r\n      }}\r\n    >\r\n      {items.map((item) => (\r\n        <div key={item.label} className=\"flex items-center gap-1.5\">\r\n          <div className=\"h-[2px] w-4\" style={{ backgroundColor: item.color }} />\r\n          <span style={{ color: \"var(--muted-foreground)\" }}>{item.label}</span>\r\n        </div>\r\n      ))}\r\n      <div className=\"flex items-center gap-1.5 ml-2\" style={{ borderLeft: \"1px solid rgba(229,195,75,0.15)\", paddingLeft: 8 }}>\r\n        <span style={{ color: \"var(--muted-foreground)\" }}>{\"Клик = профиль\"}</span>\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n\r\n// Панель графа -- узлы, связи, физика\r\nexport function GraphPanel({\r\n  onSelectAgent,\r\n  refreshToken,\r\n}: {\r\n  onSelectAgent?: (agentId: string) => void\r\n  refreshToken?: number\r\n}) {\r\n  const containerRef = useRef<HTMLDivElement>(null)\r\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\r\n  const fgRef = useRef<any>(null)\r\n  const [dimensions, setDimensions] = useState({ width: 0, height: 0 })\r\n  const [graphLoaded, setGraphLoaded] = useState(false)\r\n  const [dataLoaded, setDataLoaded] = useState(false)\n  const [agents, setAgents] = useState<Agent[]>([])\n  const [relationships, setRelationships] = useState<Relationship[]>([])\n  const [graphData, setGraphData] = useState<GraphData>({ nodes: [], links: [] })\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\r\n  const [ForceGraph, setForceGraph] = useState<React.ComponentType<any> | null>(null)\n  const [hoveredNode, setHoveredNode] = useState<GraphNode | null>(null)\n  const [tooltipPos, setTooltipPos] = useState({ x: 0, y: 0 })\n  const agentsSignatureRef = useRef(\"\")\n  const relationshipsSignatureRef = useRef(\"\")\n  const initializedRef = useRef(false)\n\n  useEffect(() => {\n    let active = true\n    if (!initializedRef.current) {\n      setDataLoaded(false)\n    }\n\n    const loadData = async () => {\n      const [loadedAgents, loadedRelationships] = await Promise.all([getAgents(), getRelationships()])\n      if (!active) return\n\n      const agentsSignature = JSON.stringify(loadedAgents.map((agent) => [agent.id, agent.name, agent.avatar, agent.mood]))\n      const relationshipsSignature = JSON.stringify(\n        loadedRelationships.map((relationship) => [relationship.from, relationship.to, relationship.sentiment, relationship.label])\n      )\n\n      let graphNeedsUpdate = false\n      if (agentsSignature !== agentsSignatureRef.current) {\n        agentsSignatureRef.current = agentsSignature\n        setAgents(loadedAgents)\n        graphNeedsUpdate = true\n      }\n\n      if (relationshipsSignature !== relationshipsSignatureRef.current) {\n        relationshipsSignatureRef.current = relationshipsSignature\n        setRelationships(loadedRelationships)\n        graphNeedsUpdate = true\n      }\n\n      if (graphNeedsUpdate) {\n        setGraphData((prev) => mergeGraphData(prev, loadedAgents, loadedRelationships))\n      }\n\n      if (!initializedRef.current) {\n        initializedRef.current = true\n        setDataLoaded(true)\n      }\n    }\n\n    void loadData()\n    const timer = setInterval(() => {\n      void loadData()\n    }, 4000)\n\n    return () => {\n      active = false\n      clearInterval(timer)\n    }\n  }, [refreshToken])\n\r\n  // Track container size\r\n  useEffect(() => {\r\n    const el = containerRef.current\r\n    if (!el) return\r\n    const observer = new ResizeObserver((entries) => {\r\n      for (const entry of entries) {\r\n        setDimensions({\r\n          width: entry.contentRect.width,\r\n          height: entry.contentRect.height,\r\n        })\r\n      }\r\n    })\r\n    observer.observe(el)\r\n    return () => observer.disconnect()\r\n  }, [])\r\n\r\n  // Dynamic import (SSR-safe)\r\n  useEffect(() => {\r\n    import(\"react-force-graph-2d\").then((mod) => {\r\n      setForceGraph(() => mod.default)\r\n      setTimeout(() => setGraphLoaded(true), 500)\r\n    })\r\n  }, [])\r\n\r\n  // Configure physics ONCE after graph renders\r\n  const physicsConfigured = useRef(false)\r\n  useEffect(() => {\r\n    const fg = fgRef.current\r\n    if (!fg || physicsConfigured.current || !graphLoaded) return\r\n    physicsConfigured.current = true\r\n\r\n    // Charge: nodes repel each other\r\n    fg.d3Force(\"charge\")?.strength(-300).distanceMax(500)\r\n\r\n    // Links: connected nodes attract with moderate strength\r\n    fg.d3Force(\"link\")?.distance(120).strength(0.35)\r\n\r\n    // Center: weak gravity toward center -- keeps the cluster centered\r\n    fg.d3Force(\"center\")?.strength(0.04)\r\n\r\n    // Collision: prevent overlap (node radius 14 + padding = 30)\r\n    import(\"d3-force\").then(({ forceCollide }) => {\r\n      fg.d3Force(\"collide\", forceCollide(30).strength(1).iterations(4))\r\n      fg.d3ReheatSimulation()\r\n    })\r\n\r\n    fg.d3ReheatSimulation()\r\n  }, [graphLoaded])\r\n\r\n  // Обработать изменение размера (fullscreen toggle) -- центрировать и прогреть физику\r\n  useEffect(() => {\r\n    const fg = fgRef.current\r\n    if (!fg || !graphLoaded || dimensions.width === 0) return\r\n    \r\n    // Небольшая задержка чтобы canvas успел обновиться\r\n    const timer = setTimeout(() => {\r\n      fg.zoomToFit(400, 40)\r\n      fg.d3ReheatSimulation()\r\n    }, 100)\r\n    \r\n    return () => clearTimeout(timer)\r\n  }, [dimensions, graphLoaded])\r\n\r\n  // Paint node -- minimal, consistent stroke width\r\n  const paintNode = useCallback(\r\n    (node: Record<string, unknown>, ctx: CanvasRenderingContext2D, globalScale: number) => {\r\n      const n = node as unknown as GraphNode\r\n      const x = n.x ?? 0\r\n      const y = n.y ?? 0\r\n      const r = 14\r\n      const isHovered = hoveredNode?.id === n.id\r\n      const fontSize = Math.max(11 / globalScale, 2.5)\r\n\r\n      ctx.save()\r\n\r\n      // Subtle glow when hovered\r\n      if (isHovered) {\r\n        ctx.beginPath()\r\n        ctx.arc(x, y, r + 6, 0, 2 * Math.PI)\r\n        ctx.fillStyle = \"rgba(229,195,75,0.06)\"\r\n        ctx.fill()\r\n      }\r\n\r\n      // Fill\r\n      ctx.beginPath()\r\n      ctx.arc(x, y, r, 0, 2 * Math.PI)\r\n      ctx.fillStyle = \"#111118\"\r\n      ctx.fill()\r\n\r\n      // Stroke -- uniform 1.5px for all\r\n      ctx.strokeStyle = isHovered ? \"#e5c34b\" : n.moodColor\r\n      ctx.lineWidth = 1.5\r\n      ctx.stroke()\r\n\r\n      // Avatar letter\r\n      ctx.textAlign = \"center\"\r\n      ctx.textBaseline = \"middle\"\r\n      ctx.font = `bold ${r * 0.8}px 'Geist Mono', monospace`\r\n      ctx.fillStyle = isHovered ? \"#e5c34b\" : n.moodColor\r\n      ctx.fillText(n.avatar, x, y + 0.5)\r\n\r\n      // Name below node\r\n      if (globalScale > 0.45) {\r\n        ctx.font = `${fontSize}px 'Geist Mono', monospace`\r\n        ctx.fillStyle = isHovered ? \"#e5c34b\" : \"rgba(229,195,75,0.3)\"\r\n        ctx.fillText(n.name, x, y + r + fontSize + 3)\r\n      }\r\n\r\n      ctx.restore()\r\n    },\r\n    [hoveredNode]\r\n  )\r\n\r\n  // Paint link -- uniform width, no labels on canvas\r\n  const paintLink = useCallback(\r\n    (link: Record<string, unknown>, ctx: CanvasRenderingContext2D) => {\r\n      const l = link as unknown as GraphLink\r\n      const source = l.source as unknown as GraphNode\r\n      const target = l.target as unknown as GraphNode\r\n      if (source.x == null || source.y == null || target.x == null || target.y == null) return\r\n\r\n      ctx.save()\r\n      ctx.beginPath()\r\n      ctx.moveTo(source.x, source.y)\r\n      ctx.lineTo(target.x, target.y)\r\n      ctx.strokeStyle = l.color\r\n      ctx.lineWidth = 1.2\r\n      ctx.globalAlpha = 0.4\r\n      ctx.stroke()\r\n      ctx.restore()\r\n    },\r\n    []\r\n  )\r\n\r\n  // Tooltip content -- shows relationships when hovering\r\n  const tooltipContent = useMemo(() => {\r\n    if (!hoveredNode) return null\r\n    const agent = agents.find((a) => a.id === hoveredNode.id)\r\n    if (!agent) return null\r\n    const moodCfg = MOOD_CONFIG[agent.mood]\r\n\r\n    const rels = relationships.filter(\r\n      (r) => r.from === agent.id || r.to === agent.id\r\n    ).map((r) => {\r\n      const otherId = r.from === agent.id ? r.to : r.from\r\n      const other = agents.find((a) => a.id === otherId)\r\n      return { name: other?.name ?? otherId, sentiment: r.sentiment, label: r.label }\r\n    })\r\n\r\n    return { agent, moodCfg, rels }\r\n  }, [hoveredNode, agents, relationships])\r\n\r\n  // Node click -- navigate to agent profile\r\n  const handleNodeClick = useCallback(\r\n    (node: Record<string, unknown>) => {\r\n      const n = node as unknown as GraphNode\r\n      if (onSelectAgent) {\r\n        onSelectAgent(n.id)\r\n      }\r\n    },\r\n    [onSelectAgent]\r\n  )\r\n\r\n  // Drag -- temporary pin, release back to physics after drag end\r\n  const handleNodeDrag = useCallback((node: Record<string, unknown>) => {\r\n    const n = node as unknown as GraphNode\r\n    n.__dragging = true\r\n    n.fx = n.x\r\n    n.fy = n.y\r\n  }, [])\r\n\r\n  const handleNodeDragEnd = useCallback((node: Record<string, unknown>) => {\r\n    const n = node as unknown as GraphNode\r\n    n.__dragging = false\r\n    // Release back to physics after a short delay\r\n    setTimeout(() => {\r\n      if (!n.__dragging) {\r\n        n.fx = undefined as unknown as null\r\n        n.fy = undefined as unknown as null\r\n      }\r\n    }, 300)\r\n  }, [])\r\n\r\n  return (\r\n    <div\r\n      ref={containerRef}\r\n      className=\"relative h-full w-full overflow-hidden\"\r\n      style={{ backgroundColor: \"var(--cyber-surface)\" }}\r\n      onMouseMove={(e) => {\r\n        const rect = containerRef.current?.getBoundingClientRect()\r\n        if (rect) {\r\n          setTooltipPos({ x: e.clientX - rect.left, y: e.clientY - rect.top })\r\n        }\r\n      }}\r\n    >\r\n      {/* Grid background */}\r\n      <div\r\n        className=\"pointer-events-none absolute inset-0 opacity-[0.04]\"\r\n        style={{\r\n          backgroundImage:\r\n            \"linear-gradient(var(--cyber-glow) 1px, transparent 1px), linear-gradient(90deg, var(--cyber-glow) 1px, transparent 1px)\",\r\n          backgroundSize: \"50px 50px\",\r\n        }}\r\n      />\r\n\r\n      <LoadingOverlay visible={!graphLoaded || !dataLoaded} />\r\n\r\n      {ForceGraph && dimensions.width > 0 && (\r\n        <ForceGraph\r\n          ref={fgRef}\r\n          graphData={graphData}\r\n          width={dimensions.width}\r\n          height={dimensions.height}\r\n          backgroundColor=\"transparent\"\r\n          // Physics: never stop\r\n          d3AlphaDecay={0.005}\r\n          d3VelocityDecay={0.25}\r\n          warmupTicks={0}\r\n          cooldownTime={Infinity}\r\n          // Nodes\r\n          nodeCanvasObject={paintNode}\r\n          nodePointerAreaPaint={(node: Record<string, unknown>, color: string, ctx: CanvasRenderingContext2D) => {\r\n            const n = node as unknown as GraphNode\r\n            const x = n.x ?? 0\r\n            const y = n.y ?? 0\r\n            // Увеличенная зона клика для Firefox\r\n            ctx.fillStyle = color\r\n            ctx.beginPath()\r\n            ctx.arc(x, y, 22, 0, 2 * Math.PI)\r\n            ctx.fill()\r\n          }}\r\n          nodeLabel={() => \"\"}\r\n          nodeVal={() => 1}\r\n          onNodeHover={(node: Record<string, unknown> | null) => {\r\n            setHoveredNode(node ? (node as unknown as GraphNode) : null)\r\n            if (containerRef.current) {\r\n              containerRef.current.style.cursor = node ? \"pointer\" : \"default\"\r\n            }\r\n          }}\r\n          onNodeClick={handleNodeClick}\r\n          onNodeDrag={handleNodeDrag}\r\n          onNodeDragEnd={handleNodeDragEnd}\r\n          enableNodeDrag={true}\r\n          // Связи\r\n          linkCanvasObject={paintLink}\r\n          linkDirectionalParticles={0}\r\n          linkPointerAreaPaint={() => {}}\r\n          // Навигация\r\n          enableZoomInteraction={true}\r\n          enablePanInteraction={true}\r\n          minZoom={0.3}\r\n          maxZoom={6}\r\n        />\r\n      )}\r\n\r\n      {/* Tooltip -- only on hover, disappears immediately on leave */}\r\n      {hoveredNode && tooltipContent && (\r\n        <div\r\n          className=\"absolute z-40 pointer-events-none font-mono\"\r\n          style={{\r\n            left: Math.min(tooltipPos.x + 18, dimensions.width - 230),\r\n            top: Math.max(tooltipPos.y - 14, 8),\r\n            backgroundColor: \"rgba(10,10,15,0.94)\",\r\n            border: \"1px solid rgba(229,195,75,0.2)\",\r\n            padding: \"10px 14px\",\r\n            minWidth: \"180px\",\r\n            maxWidth: \"240px\",\r\n          }}\r\n        >\r\n          <div className=\"flex items-center gap-2 mb-1.5\">\r\n            <div\r\n              className=\"w-6 h-6 rounded-full flex items-center justify-center text-[10px] font-bold\"\r\n              style={{\r\n                backgroundColor: tooltipContent.moodCfg.color + \"25\",\r\n                color: tooltipContent.moodCfg.color,\r\n                border: `1px solid ${tooltipContent.moodCfg.color}50`,\r\n              }}\r\n            >\r\n              {tooltipContent.agent.avatar}\r\n            </div>\r\n            <span className=\"text-sm\" style={{ color: \"var(--cyber-glow)\" }}>\r\n              {tooltipContent.agent.name}\r\n            </span>\r\n          </div>\r\n\r\n          <div className=\"text-[10px] flex items-center gap-1.5 mb-2\" style={{ color: tooltipContent.moodCfg.color }}>\r\n            <div className=\"w-1.5 h-1.5 rounded-full\" style={{ backgroundColor: tooltipContent.moodCfg.color }} />\r\n            {tooltipContent.moodCfg.label}\r\n            <span style={{ color: \"var(--muted-foreground)\", marginLeft: 4 }}>\r\n              {tooltipContent.agent.traits.slice(0, 2).join(\", \")}\r\n            </span>\r\n          </div>\r\n\r\n          {tooltipContent.rels.length > 0 && (\r\n            <div style={{ borderTop: \"1px solid rgba(229,195,75,0.1)\" }} className=\"pt-1.5\">\r\n              <div className=\"text-[9px] uppercase tracking-widest mb-1\" style={{ color: \"var(--muted-foreground)\" }}>\r\n                {\"Связи\"}\r\n              </div>\r\n              {tooltipContent.rels.map((rel) => (\r\n                <div key={rel.name} className=\"flex items-center justify-between text-[10px] py-0.5\">\r\n                  <span style={{ color: \"var(--foreground)\" }}>{rel.name}</span>\r\n                  <span style={{ color: sentimentToColor(rel.sentiment), fontSize: \"9px\" }}>{rel.label}</span>\r\n                </div>\r\n              ))}\r\n            </div>\r\n          )}\r\n\r\n          {tooltipContent.rels.length === 0 && (\r\n            <div className=\"text-[10px] pt-1\" style={{ color: \"var(--muted-foreground)\", borderTop: \"1px solid rgba(229,195,75,0.1)\", paddingTop: 6 }}>\r\n              {\"Нет связей с другими агентами\"}\r\n            </div>\r\n          )}\r\n        </div>\r\n      )}\r\n\r\n      <Legend />\r\n    </div>\r\n  )\r\n}\r\n\r\n\r\n","\"use client\"\r\n\r\nimport { useEffect, useState } from \"react\"\nimport { MOOD_CONFIG, getAgents, getEvents, type Agent, type AgentEvent } from \"@/lib/data\"\n\r\n// Типы событий и их стили\r\nconst EVENT_TYPE_LABELS: Record<AgentEvent[\"type\"], { label: string; color: string }> = {\r\n  chat:    { label: \"ЧАТ\",     color: \"#4ade80\" },\r\n  action:  { label: \"ДЕЙСТВИЕ\", color: \"#e5c34b\" },\r\n  emotion: { label: \"ЭМОЦИЯ\",  color: \"#c084fc\" },\r\n  system:  { label: \"СИСТЕМА\", color: \"#60a5fa\" },\r\n}\r\n\r\n// Форматировать время\r\nfunction formatTime(iso: string) {\r\n  const d = new Date(iso)\r\n  return d.toLocaleTimeString(\"ru-RU\", { hour: \"2-digit\", minute: \"2-digit\", second: \"2-digit\" })\r\n}\r\n\r\nexport function EventsPanel({ refreshToken }: { refreshToken?: number }) {\n  const [events, setEvents] = useState<AgentEvent[]>([])\n  const [agents, setAgents] = useState<Agent[]>([])\n  const [loading, setLoading] = useState(true)\n\n  useEffect(() => {\n    let active = true\n    setLoading(true)\n\n    Promise.all([getEvents(), getAgents()])\n      .then(([loadedEvents, loadedAgents]) => {\n        if (!active) return\n        setEvents(loadedEvents)\n        setAgents(loadedAgents)\n      })\n      .finally(() => {\n        if (active) {\n          setLoading(false)\n        }\n      })\n\n    return () => {\n      active = false\n    }\n  }, [refreshToken])\n\n  return (\n    <div className=\"flex h-full w-full\" style={{ backgroundColor: \"var(--cyber-surface)\" }}>\n      {/* Слева: список агентов */}\r\n      <aside\r\n        className=\"shrink-0 flex flex-col gap-3 overflow-y-auto border-r py-4 px-3\"\r\n        style={{ borderColor: \"rgba(229,195,75,0.15)\", width: \"clamp(160px, 15%, 220px)\" }}\r\n      >\r\n        <span\r\n          className=\"font-mono text-[10px] tracking-widest uppercase px-1\"\r\n          style={{ color: \"var(--muted-foreground)\" }}\r\n        >\r\n          {\"АГЕНТЫ ОНЛАЙН\"}\r\n        </span>\r\n        {agents.map((agent) => {\r\n          const mc = MOOD_CONFIG[agent.mood]\r\n          return (\r\n            <div\r\n              key={agent.id}\r\n              className=\"flex items-center gap-2 px-2 py-2 rounded-sm\"\r\n              style={{ backgroundColor: \"rgba(229,195,75,0.04)\" }}\r\n            >\r\n              <div\r\n                className=\"shrink-0 flex items-center justify-center font-mono text-xs font-bold rounded-sm\"\r\n                style={{\r\n                  width: 32,\r\n                  height: 32,\r\n                  backgroundColor: \"rgba(229,195,75,0.1)\",\r\n                  color: mc.color,\r\n                  border: `1px solid ${mc.color}`,\r\n                }}\r\n              >\r\n                {agent.avatar}\r\n              </div>\r\n              <div className=\"min-w-0\">\r\n                <div className=\"font-mono text-xs truncate\" style={{ color: \"var(--foreground)\" }}>\r\n                  {agent.name}\r\n                </div>\r\n                <div className=\"font-mono text-[10px]\" style={{ color: mc.color }}>\r\n                  {mc.label}\r\n                </div>\r\n              </div>\r\n            </div>\r\n          )\r\n        })}\r\n      </aside>\r\n\r\n      {/* Справа: лента */}\r\n      <div className=\"flex-1 flex flex-col min-w-0\">\r\n        <div\r\n          className=\"shrink-0 flex items-center justify-between px-4 py-2 border-b\"\r\n          style={{ borderColor: \"rgba(229,195,75,0.15)\" }}\r\n        >\r\n          <span className=\"font-mono text-sm tracking-widest uppercase\" style={{ color: \"var(--cyber-glow)\" }}>\r\n            {\"ЛЕНТА СОБЫТИЙ\"}\r\n          </span>\r\n          <span className=\"font-mono text-[10px]\" style={{ color: \"var(--muted-foreground)\" }}>\r\n            {events.length} {\"событий\"}\r\n          </span>\r\n        </div>\r\n\n        <div className=\"flex-1 overflow-y-auto px-4 py-3 flex flex-col gap-1.5\">\n          {loading && (\n            <div className=\"font-mono text-xs\" style={{ color: \"var(--muted-foreground)\" }}>\n              Загрузка событий...\n            </div>\n          )}\n\n          {!loading && events.length === 0 && (\n            <div className=\"font-mono text-xs\" style={{ color: \"var(--muted-foreground)\" }}>\n              Событий пока нет\n            </div>\n          )}\n\n          {events.map((evt) => {\n            const typeConf = EVENT_TYPE_LABELS[evt.type]\n            return (\n              <div\r\n                key={evt.id}\r\n                className=\"group flex items-start gap-3 px-3 py-2.5 rounded-sm\"\r\n                style={{\r\n                  backgroundColor: \"rgba(229,195,75,0.02)\",\r\n                  borderLeft: `2px solid ${typeConf.color}`,\r\n                  transition: \"background-color 0.15s ease\",\r\n                }}\r\n                onMouseEnter={(e) => {\r\n                  e.currentTarget.style.backgroundColor = \"rgba(229,195,75,0.06)\"\r\n                }}\r\n                onMouseLeave={(e) => {\r\n                  e.currentTarget.style.backgroundColor = \"rgba(229,195,75,0.02)\"\r\n                }}\r\n              >\r\n                {/* Timestamp */}\r\n                <span\r\n                  className=\"shrink-0 font-mono text-[11px] tabular-nums pt-0.5\"\r\n                  style={{ color: \"var(--muted-foreground)\", width: \"64px\" }}\r\n                >\r\n                  {formatTime(evt.timestamp)}\r\n                </span>\r\n\r\n                {/* Type badge */}\r\n                <span\r\n                  className=\"shrink-0 font-mono text-[9px] tracking-wider uppercase px-1.5 py-0.5 rounded-sm mt-0.5\"\r\n                  style={{\r\n                    color: typeConf.color,\r\n                    backgroundColor: `${typeConf.color}15`,\r\n                    border: `1px solid ${typeConf.color}30`,\r\n                  }}\r\n                >\r\n                  {typeConf.label}\r\n                </span>\r\n\r\n                {/* Content */}\r\n                <div className=\"flex-1 min-w-0\">\r\n                  <span className=\"font-mono text-xs font-bold mr-2\" style={{ color: \"var(--cyber-glow)\" }}>\r\n                    {evt.agentName}\r\n                  </span>\r\n                  <span className=\"font-mono text-xs\" style={{ color: \"var(--foreground)\", opacity: 0.85 }}>\r\n                    {evt.text}\r\n                  </span>\r\n                </div>\r\n              </div>\r\n            )\r\n          })}\r\n        </div>\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n","\"use client\"\r\n\r\nimport { useEffect, useRef, useState } from \"react\"\r\nimport {\r\n  deleteAgent,\r\n  MOOD_CONFIG,\r\n  generateAgentWithAi,\r\n  getAgents,\r\n  getEvents,\r\n  getRelationships,\r\n  type Agent,\r\n  type AgentEvent,\r\n  type Relationship,\r\n} from \"@/lib/data\"\r\n\r\nfunction AgentDetail({\r\n  agent,\r\n  onBack,\r\n  fromGraph,\r\n  allAgents,\r\n  allEvents,\r\n  allRelationships,\r\n  onDelete,\r\n  deleting,\r\n  deleteError,\r\n}: {\r\n  agent: Agent\r\n  onBack: () => void\r\n  fromGraph?: boolean\r\n  allAgents: Agent[]\r\n  allEvents: AgentEvent[]\r\n  allRelationships: Relationship[]\r\n  onDelete: (agentId: string) => void\r\n  deleting: boolean\r\n  deleteError: string | null\r\n}) {\r\n  const mc = MOOD_CONFIG[agent.mood]\r\n  const events = allEvents.filter((e) => e.agentId === agent.id)\r\n  const relations = allRelationships.filter(\r\n    (r) => r.from === agent.id || r.to === agent.id\r\n  )\r\n\r\n  return (\r\n    <div className=\"flex flex-col h-full\" style={{ backgroundColor: \"var(--cyber-surface)\" }}>\r\n      {/* Header */}\r\n      <div\r\n        className=\"shrink-0 flex items-center gap-3 px-5 py-3 border-b\"\r\n        style={{ borderColor: \"rgba(229,195,75,0.15)\" }}\r\n      >\r\n        <button\r\n          onClick={onBack}\r\n          className=\"font-mono text-xs tracking-wider uppercase cursor-pointer\"\r\n          style={{\r\n            color: \"var(--cyber-glow)\",\r\n            padding: \"4px 10px\",\r\n            border: \"1px solid rgba(229,195,75,0.25)\",\r\n            backgroundColor: \"rgba(229,195,75,0.05)\",\r\n            transition: \"all 0.2s ease\",\r\n          }}\r\n          onMouseEnter={(e) => {\r\n            e.currentTarget.style.backgroundColor = \"rgba(229,195,75,0.15)\"\r\n            e.currentTarget.style.borderColor = \"rgba(229,195,75,0.5)\"\r\n          }}\r\n          onMouseLeave={(e) => {\r\n            e.currentTarget.style.backgroundColor = \"rgba(229,195,75,0.05)\"\r\n            e.currentTarget.style.borderColor = \"rgba(229,195,75,0.25)\"\r\n          }}\r\n        >\r\n          {fromGraph ? \"<- Рљ Р“Р РђР¤РЈ\" : \"<- РќРђР—РђР”\"}\r\n        </button>\r\n        <span className=\"font-mono text-sm tracking-widest uppercase\" style={{ color: \"var(--cyber-glow)\" }}>\r\n          {\"Р”РћРЎР¬Р• РђР“Р•РќРўРђ\"}\r\n        </span>\r\n        <button\r\n          onClick={() => onDelete(agent.id)}\r\n          disabled={deleting}\r\n          className=\"ml-auto font-mono text-xs tracking-wider uppercase cursor-pointer disabled:cursor-not-allowed\"\r\n          style={{\r\n            color: deleting ? \"var(--muted-foreground)\" : \"#f87171\",\r\n            padding: \"4px 10px\",\r\n            border: \"1px solid rgba(248,113,113,0.35)\",\r\n            backgroundColor: deleting ? \"rgba(248,113,113,0.05)\" : \"rgba(248,113,113,0.1)\",\r\n            transition: \"all 0.2s ease\",\r\n          }}\r\n        >\r\n          {deleting ? \"УДАЛЕНИЕ...\" : \"УДАЛИТЬ АГЕНТА\"}\r\n        </button>\r\n      </div>\r\n\r\n      {/* Content */}\r\n      <div className=\"flex-1 overflow-y-auto px-5 py-4 flex flex-col gap-5\">\r\n        {/* Profile card */}\r\n        <div className=\"flex items-start gap-4\">\r\n          <div\r\n            className=\"shrink-0 flex items-center justify-center font-mono text-2xl font-bold rounded-sm\"\r\n            style={{\r\n              width: 64,\r\n              height: 64,\r\n              backgroundColor: \"rgba(229,195,75,0.1)\",\r\n              color: mc.color,\r\n              border: `2px solid ${mc.color}`,\r\n              boxShadow: `0 0 12px ${mc.color}30`,\r\n            }}\r\n          >\r\n            {agent.avatar}\r\n          </div>\r\n          <div className=\"flex flex-col gap-1 min-w-0\">\r\n            <h2 className=\"font-mono text-lg uppercase tracking-wider\" style={{ color: \"var(--foreground)\" }}>\r\n              {agent.name}\r\n            </h2>\r\n            <div className=\"flex items-center gap-2\">\r\n              <div className=\"h-2 w-2 rounded-full\" style={{ backgroundColor: mc.color }} />\r\n              <span className=\"font-mono text-xs\" style={{ color: mc.color }}>{mc.label}</span>\r\n            </div>\r\n            <p className=\"font-mono text-xs mt-1\" style={{ color: \"var(--muted-foreground)\" }}>\r\n              {agent.description}\r\n            </p>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Traits */}\r\n        <div>\r\n          <h3 className=\"font-mono text-[10px] tracking-widest uppercase mb-2\" style={{ color: \"var(--muted-foreground)\" }}>\r\n            {\"Р§Р•Р РўР« РҐРђР РђРљРўР•Р Рђ\"}\r\n          </h3>\r\n          <div className=\"flex flex-wrap gap-1.5\">\r\n            {agent.traits.map((t) => (\r\n              <span\r\n                key={t}\r\n                className=\"font-mono text-[11px] px-2 py-0.5 rounded-sm\"\r\n                style={{\r\n                  color: \"var(--cyber-glow)\",\r\n                  backgroundColor: \"rgba(229,195,75,0.08)\",\r\n                  border: \"1px solid rgba(229,195,75,0.2)\",\r\n                }}\r\n              >\r\n                {t}\r\n              </span>\r\n            ))}\r\n          </div>\r\n        </div>\r\n\r\n        {/* Current plan */}\r\n        <div>\r\n          <h3 className=\"font-mono text-[10px] tracking-widest uppercase mb-2\" style={{ color: \"var(--muted-foreground)\" }}>\r\n            {\"РўР•РљРЈР©РР™ РџР›РђРќ\"}\r\n          </h3>\r\n          <p className=\"font-mono text-xs\" style={{ color: \"var(--foreground)\", opacity: 0.9 }}>\r\n            {agent.currentPlan}\r\n          </p>\r\n        </div>\r\n\r\n        {/* Relationships */}\r\n        <div>\r\n          <h3 className=\"font-mono text-[10px] tracking-widest uppercase mb-2\" style={{ color: \"var(--muted-foreground)\" }}>\r\n            {\"РћРўРќРћРЁР•РќРРЇ\"}\r\n          </h3>\r\n          <div className=\"flex flex-col gap-1.5\">\r\n            {relations.map((rel, i) => {\r\n              const otherId = rel.from === agent.id ? rel.to : rel.from\r\n              const other = allAgents.find((a) => a.id === otherId)\r\n              const sentColor = rel.sentiment > 0 ? \"#4ade80\" : rel.sentiment < 0 ? \"#f87171\" : \"#a0a0b0\"\r\n              return (\r\n                <div\r\n                  key={i}\r\n                  className=\"flex items-center justify-between px-3 py-2 rounded-sm\"\r\n                  style={{ backgroundColor: \"rgba(229,195,75,0.03)\", borderLeft: `2px solid ${sentColor}` }}\r\n                >\r\n                  <span className=\"font-mono text-xs\" style={{ color: \"var(--foreground)\" }}>\r\n                    {other?.name || otherId}\r\n                  </span>\r\n                  <div className=\"flex items-center gap-2\">\r\n                    <span className=\"font-mono text-[10px]\" style={{ color: \"var(--muted-foreground)\" }}>\r\n                      {rel.label}\r\n                    </span>\r\n                    <span className=\"font-mono text-xs font-bold\" style={{ color: sentColor }}>\r\n                      {rel.sentiment > 0 ? \"+\" : \"\"}{(rel.sentiment * 100).toFixed(0)}%\r\n                    </span>\r\n                  </div>\r\n                </div>\r\n              )\r\n            })}\r\n          </div>\r\n        </div>\r\n\r\n        {/* Memories */}\r\n        <div>\r\n          <h3 className=\"font-mono text-[10px] tracking-widest uppercase mb-2\" style={{ color: \"var(--muted-foreground)\" }}>\r\n            {\"Р’РћРЎРџРћРњРРќРђРќРРЇ\"}\r\n          </h3>\r\n          <div className=\"flex flex-col gap-1\">\r\n            {agent.memories.map((m, i) => (\r\n              <div key={i} className=\"flex items-start gap-2 py-1\">\r\n                <div className=\"shrink-0 mt-1.5 h-1 w-1 rounded-full\" style={{ backgroundColor: \"var(--cyber-glow)\", opacity: 0.5 }} />\r\n                <span className=\"font-mono text-xs\" style={{ color: \"var(--foreground)\", opacity: 0.8 }}>{m}</span>\r\n              </div>\r\n            ))}\r\n          </div>\r\n        </div>\r\n\r\n        {/* Recent events */}\r\n        <div>\n          <h3 className=\"font-mono text-[10px] tracking-widest uppercase mb-2\" style={{ color: \"var(--muted-foreground)\" }}>\n            {\"РџРћРЎР›Р•Р”РќРР• РЎРћР‘Р«РўРРЇ\"}\n          </h3>\n          <div className=\"flex flex-col gap-1\">\r\n            {events.map((evt) => (\r\n              <div key={evt.id} className=\"flex items-start gap-2 py-1.5 px-2 rounded-sm\" style={{ backgroundColor: \"rgba(229,195,75,0.02)\" }}>\r\n                <span className=\"shrink-0 font-mono text-[10px] tabular-nums\" style={{ color: \"var(--muted-foreground)\", width: 56 }}>\r\n                  {new Date(evt.timestamp).toLocaleTimeString(\"ru-RU\", { hour: \"2-digit\", minute: \"2-digit\" })}\r\n                </span>\r\n                <span className=\"font-mono text-xs\" style={{ color: \"var(--foreground)\", opacity: 0.8 }}>{evt.text}</span>\r\n              </div>\r\n            ))}\n          </div>\n        </div>\n\n        {deleteError ? (\n          <div className=\"font-mono text-[11px]\" style={{ color: \"#f87171\" }}>\n            {deleteError}\n          </div>\n        ) : null}\n      </div>\n    </div>\n  )\n}\n\r\nexport function AgentsPanel({\r\n  preSelectedAgentId,\r\n  onClearSelection,\r\n  fromGraph,\r\n  refreshToken,\r\n}: {\r\n  preSelectedAgentId?: string | null\r\n  onClearSelection?: () => void\r\n  fromGraph?: boolean\r\n  refreshToken?: number\r\n}) {\r\n  const [selectedId, setSelectedId] = useState<string | null>(preSelectedAgentId ?? null)\r\n  const [agents, setAgents] = useState<Agent[]>([])\r\n  const [events, setEvents] = useState<AgentEvent[]>([])\r\n  const [relationships, setRelationships] = useState<Relationship[]>([])\r\n  const [loading, setLoading] = useState(true)\n  const [generationPrompt, setGenerationPrompt] = useState(\"\")\n  const [generationError, setGenerationError] = useState<string | null>(null)\n  const [generating, setGenerating] = useState(false)\n  const [deleting, setDeleting] = useState(false)\n  const [deleteError, setDeleteError] = useState<string | null>(null)\n\n  const reloadAll = async () => {\n    const [loadedAgents, loadedEvents, loadedRelationships] = await Promise.all([\n      getAgents(),\n      getEvents(),\n      getRelationships(),\n    ])\n    setAgents(loadedAgents)\n    setEvents(loadedEvents)\n    setRelationships(loadedRelationships)\n  }\n\r\n  useEffect(() => {\r\n    let active = true\r\n    setLoading(true)\r\n\r\n    Promise.all([getAgents(), getEvents(), getRelationships()])\r\n      .then(([loadedAgents, loadedEvents, loadedRelationships]) => {\r\n        if (!active) return\r\n        setAgents(loadedAgents)\r\n        setEvents(loadedEvents)\r\n        setRelationships(loadedRelationships)\r\n      })\r\n      .finally(() => {\r\n        if (active) {\r\n          setLoading(false)\r\n        }\r\n      })\r\n\r\n    return () => {\r\n      active = false\r\n    }\r\n  }, [refreshToken])\r\n\r\n  const handleGenerate = async () => {\r\n    const prompt = generationPrompt.trim()\r\n    if (!prompt || generating) {\r\n      return\r\n    }\r\n\r\n    setGenerating(true)\r\n    setGenerationError(null)\r\n\r\n    try {\r\n      const created = await generateAgentWithAi(prompt)\r\n      if (!created) {\r\n        setGenerationError(\"РќРµ СѓРґР°Р»РѕСЃСЊ СЃРіРµРЅРµСЂРёСЂРѕРІР°С‚СЊ Р°РіРµРЅС‚Р°. РџСЂРѕРІРµСЂСЊ backend Рё OPENAI_API_KEY.\")\r\n        return\r\n      }\r\n\r\n      await reloadAll()\n      setGenerationPrompt(\"\")\n      setSelectedId(created.id)\n    } finally {\n      setGenerating(false)\n    }\n  }\n\n  const handleDelete = async (agentId: string) => {\n    if (deleting) {\n      return\n    }\n\n    const agentName = agents.find((agent) => agent.id === agentId)?.name ?? agentId\n    if (!window.confirm(`Удалить агента \"${agentName}\"?`)) {\n      return\n    }\n\n    setDeleting(true)\n    setDeleteError(null)\n    try {\n      const removed = await deleteAgent(agentId)\n      if (!removed) {\n        setDeleteError(\"Не удалось удалить агента. Проверь backend и попробуй снова.\")\n        return\n      }\n\n      await reloadAll()\n      setSelectedId(null)\n      onClearSelection?.()\n    } finally {\n      setDeleting(false)\n    }\n  }\n\r\n  // РЎРёРЅС…СЂРѕ СЃ РІРЅРµС€РЅРёРј РІС‹Р±РѕСЂРѕРј (РёР· РєР»РёРєР° РЅР° РЅРѕРґСѓ)\r\n  const prevPreSelected = useRef(preSelectedAgentId)\r\n  if (preSelectedAgentId && preSelectedAgentId !== prevPreSelected.current) {\r\n    prevPreSelected.current = preSelectedAgentId\r\n    if (selectedId !== preSelectedAgentId) {\r\n      setSelectedId(preSelectedAgentId)\r\n    }\r\n  }\r\n\r\n  const selected = agents.find((a) => a.id === selectedId)\r\n\r\n  if (selected) {\r\n    return (\r\n      <AgentDetail\n        agent={selected}\n        allAgents={agents}\n        allEvents={events}\n        allRelationships={relationships}\n        onDelete={handleDelete}\n        deleting={deleting}\n        deleteError={deleteError}\n        onBack={() => {\n          setSelectedId(null)\n          onClearSelection?.()\n        }}\n        fromGraph={fromGraph}\r\n      />\r\n    )\r\n  }\r\n\r\n  if (loading) {\r\n    return (\r\n      <div className=\"flex h-full items-center justify-center font-mono text-xs\" style={{ backgroundColor: \"var(--cyber-surface)\", color: \"var(--muted-foreground)\" }}>\r\n        Р—Р°РіСЂСѓР·РєР° Р°РіРµРЅС‚РѕРІ...\r\n      </div>\r\n    )\r\n  }\r\n\r\n  return (\r\n    <div className=\"flex flex-col h-full\" style={{ backgroundColor: \"var(--cyber-surface)\" }}>\r\n      <div\r\n        className=\"shrink-0 flex items-center justify-between px-5 py-3 border-b\"\r\n        style={{ borderColor: \"rgba(229,195,75,0.15)\" }}\r\n      >\r\n        <span className=\"font-mono text-sm tracking-widest uppercase\" style={{ color: \"var(--cyber-glow)\" }}>\r\n          {\"РЎРџРРЎРћРљ РђР“Р•РќРўРћР’\"}\r\n        </span>\r\n        <span className=\"font-mono text-[10px]\" style={{ color: \"var(--muted-foreground)\" }}>\r\n          {agents.length} {\"Р°РіРµРЅС‚РѕРІ\"}\r\n        </span>\r\n      </div>\r\n\r\n      <div className=\"px-5 py-3 border-b\" style={{ borderColor: \"rgba(229,195,75,0.12)\" }}>\r\n        <div className=\"flex gap-2\">\r\n          <input\r\n            type=\"text\"\r\n            value={generationPrompt}\r\n            onChange={(e) => setGenerationPrompt(e.target.value)}\r\n            placeholder=\"РћРїРёС€Рё Р°РіРµРЅС‚Р° РґР»СЏ РР...\"\r\n            className=\"flex-1 font-mono text-xs px-3 py-2 rounded-sm outline-none\"\r\n            style={{\r\n              backgroundColor: \"rgba(229,195,75,0.04)\",\r\n              border: \"1px solid rgba(229,195,75,0.2)\",\r\n              color: \"var(--foreground)\",\r\n            }}\r\n            disabled={generating}\r\n          />\r\n          <button\r\n            onClick={handleGenerate}\r\n            disabled={generating || generationPrompt.trim().length === 0}\r\n            className=\"font-mono text-xs tracking-wider uppercase px-3 py-2 rounded-sm cursor-pointer disabled:cursor-not-allowed\"\r\n            style={{\r\n              color: generating ? \"var(--muted-foreground)\" : \"var(--cyber-glow)\",\r\n              backgroundColor: generating ? \"rgba(229,195,75,0.02)\" : \"rgba(229,195,75,0.08)\",\r\n              border: \"1px solid rgba(229,195,75,0.25)\",\r\n            }}\r\n          >\r\n            {generating ? \"Р“Р•РќР•Р РђР¦РРЇ...\" : \"РЎРћР—Р”РђРўР¬ РР\"}\r\n          </button>\r\n        </div>\r\n        {generationError ? (\r\n          <p className=\"mt-2 font-mono text-[10px]\" style={{ color: \"#f87171\" }}>\r\n            {generationError}\r\n          </p>\r\n        ) : null}\r\n      </div>\r\n\r\n      <div className=\"flex-1 overflow-y-auto px-5 py-4 grid grid-cols-1 md:grid-cols-2 gap-3 auto-rows-min\">\r\n        {agents.length === 0 ? (\r\n          <div\r\n            className=\"col-span-full flex items-center justify-center font-mono text-xs py-8\"\r\n            style={{ color: \"var(--muted-foreground)\" }}\r\n          >\r\n            РђРіРµРЅС‚РѕРІ РїРѕРєР° РЅРµС‚. РћРїРёС€Рё РїРµСЂРІРѕРіРѕ Рё РЅР°Р¶РјРё \"РЎРћР—Р”РђРўР¬ РР\".\r\n          </div>\r\n        ) : null}\r\n        {agents.map((agent) => {\r\n          const mc = MOOD_CONFIG[agent.mood]\r\n          return (\r\n            <button\r\n              key={agent.id}\r\n              onClick={() => setSelectedId(agent.id)}\r\n              className=\"text-left p-4 rounded-sm cursor-pointer flex items-start gap-3\"\r\n              style={{\r\n                backgroundColor: \"rgba(229,195,75,0.03)\",\r\n                border: \"1px solid rgba(229,195,75,0.1)\",\r\n                transition: \"all 0.2s ease\",\r\n              }}\r\n              onMouseEnter={(e) => {\r\n                e.currentTarget.style.backgroundColor = \"rgba(229,195,75,0.08)\"\r\n                e.currentTarget.style.borderColor = \"rgba(229,195,75,0.3)\"\r\n                e.currentTarget.style.boxShadow = \"0 0 12px rgba(229,195,75,0.06)\"\r\n              }}\r\n              onMouseLeave={(e) => {\r\n                e.currentTarget.style.backgroundColor = \"rgba(229,195,75,0.03)\"\r\n                e.currentTarget.style.borderColor = \"rgba(229,195,75,0.1)\"\r\n                e.currentTarget.style.boxShadow = \"none\"\r\n              }}\r\n            >\r\n              <div\r\n                className=\"shrink-0 flex items-center justify-center font-mono text-lg font-bold rounded-sm\"\r\n                style={{\r\n                  width: 48,\r\n                  height: 48,\r\n                  backgroundColor: \"rgba(229,195,75,0.08)\",\r\n                  color: mc.color,\r\n                  border: `1px solid ${mc.color}`,\r\n                }}\r\n              >\r\n                {agent.avatar}\r\n              </div>\r\n              <div className=\"flex-1 min-w-0\">\r\n                <div className=\"flex items-center gap-2\">\r\n                  <span className=\"font-mono text-sm uppercase\" style={{ color: \"var(--foreground)\" }}>\r\n                    {agent.name}\r\n                  </span>\r\n                  <div className=\"flex items-center gap-1\">\r\n                    <div className=\"h-1.5 w-1.5 rounded-full\" style={{ backgroundColor: mc.color }} />\r\n                    <span className=\"font-mono text-[10px]\" style={{ color: mc.color }}>{mc.label}</span>\r\n                  </div>\r\n                </div>\r\n                <p className=\"font-mono text-[11px] mt-1 line-clamp-2\" style={{ color: \"var(--muted-foreground)\" }}>\r\n                  {agent.description}\r\n                </p>\r\n                <div className=\"flex flex-wrap gap-1 mt-2\">\r\n                  {agent.traits.map((t) => (\r\n                    <span\r\n                      key={t}\r\n                      className=\"font-mono text-[9px] px-1.5 py-0.5 rounded-sm\"\r\n                      style={{\r\n                        color: \"var(--cyber-glow)\",\r\n                        backgroundColor: \"rgba(229,195,75,0.06)\",\r\n                        border: \"1px solid rgba(229,195,75,0.15)\",\r\n                      }}\r\n                    >\r\n                      {t}\r\n                    </span>\r\n                  ))}\r\n                </div>\r\n              </div>\r\n            </button>\r\n          )\r\n        })}\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n","\"use client\"\r\n\r\nimport { useState, useEffect } from \"react\"\r\nimport { MOOD_CONFIG, getStats, type WorldStats } from \"@/lib/data\"\r\n\r\nfunction StatCard({ label, value, sub }: { label: string; value: string | number; sub?: string }) {\r\n  return (\r\n    <div\r\n      className=\"flex flex-col gap-1 p-4 rounded-sm\"\r\n      style={{\r\n        backgroundColor: \"rgba(229,195,75,0.03)\",\r\n        border: \"1px solid rgba(229,195,75,0.1)\",\r\n      }}\r\n    >\r\n      <span className=\"font-mono text-[10px] tracking-widest uppercase\" style={{ color: \"var(--muted-foreground)\" }}>\r\n        {label}\r\n      </span>\r\n      <span className=\"font-mono text-2xl tabular-nums\" style={{ color: \"var(--cyber-glow)\", textShadow: \"0 0 10px rgba(229,195,75,0.3)\" }}>\r\n        {value}\r\n      </span>\r\n      {sub && (\r\n        <span className=\"font-mono text-[10px]\" style={{ color: \"var(--muted-foreground)\" }}>{sub}</span>\r\n      )}\r\n    </div>\r\n  )\r\n}\r\n\r\nfunction BarChart({ items, maxVal }: { items: { label: string; value: number; color: string }[]; maxVal: number }) {\r\n  return (\r\n    <div className=\"flex flex-col gap-2\">\r\n      {items.map((item) => (\r\n        <div key={item.label} className=\"flex items-center gap-3\">\r\n          <span className=\"font-mono text-[10px] tracking-wider uppercase shrink-0\" style={{ color: \"var(--muted-foreground)\", width: 80 }}>\r\n            {item.label}\r\n          </span>\r\n          <div className=\"flex-1 h-5 rounded-sm\" style={{ backgroundColor: \"rgba(229,195,75,0.06)\" }}>\r\n            <div\r\n              className=\"h-full rounded-sm\"\r\n              style={{\r\n                width: `${Math.max((item.value / maxVal) * 100, 2)}%`,\r\n                backgroundColor: item.color,\r\n                opacity: 0.7,\r\n                boxShadow: `0 0 8px ${item.color}40`,\r\n                transition: \"width 0.5s ease\",\r\n              }}\r\n            />\r\n          </div>\r\n          <span className=\"font-mono text-xs tabular-nums shrink-0\" style={{ color: item.color, width: 36, textAlign: \"right\" }}>\r\n            {item.value}\r\n          </span>\r\n        </div>\r\n      ))}\r\n    </div>\r\n  )\r\n}\r\n\r\nexport function StatsPanel({ refreshToken }: { refreshToken?: number }) {\n  const [stats, setStats] = useState<WorldStats | null>(null)\n\r\n  // Грузим статистику -- при подключении БД заменить getStats()\r\n  useEffect(() => {\n    let active = true\n    setStats(null)\n    getStats().then((loadedStats) => {\n      if (active) {\n        setStats(loadedStats)\n      }\n    })\n\r\n    return () => {\n      active = false\n    }\n  }, [refreshToken])\n\r\n  if (!stats) {\r\n    return (\r\n      <div className=\"flex h-full items-center justify-center font-mono text-xs\" style={{ backgroundColor: \"var(--cyber-surface)\", color: \"var(--muted-foreground)\" }}>\r\n        Загрузка статистики...\r\n      </div>\r\n    )\r\n  }\r\n\r\n  const eventTypeColors: Record<string, string> = {\r\n    chat: \"#4ade80\",\r\n    action: \"#e5c34b\",\r\n    emotion: \"#c084fc\",\r\n    system: \"#60a5fa\",\r\n  }\r\n\r\n  const eventTypeLabels: Record<string, string> = {\r\n    chat: \"Чат\",\r\n    action: \"Действие\",\r\n    emotion: \"Эмоция\",\r\n    system: \"Система\",\r\n  }\r\n\r\n  const maxEventCount = Math.max(1, ...stats.eventsByType.map((e) => e.count))\r\n  const maxMoodCount = Math.max(1, ...stats.moodDistribution.map((m) => m.count))\r\n  const topRelationshipColor =\r\n    stats.topRelationship.sentiment > 0\r\n      ? \"#4ade80\"\r\n      : stats.topRelationship.sentiment < 0\r\n        ? \"#f87171\"\r\n        : \"var(--muted-foreground)\"\r\n\r\n  return (\r\n    <div className=\"flex flex-col h-full\" style={{ backgroundColor: \"var(--cyber-surface)\" }}>\r\n      <div\r\n        className=\"shrink-0 flex items-center px-5 py-3 border-b\"\r\n        style={{ borderColor: \"rgba(229,195,75,0.15)\" }}\r\n      >\r\n        <span className=\"font-mono text-sm tracking-widest uppercase\" style={{ color: \"var(--cyber-glow)\" }}>\r\n          {\"СТАТИСТИКА МИРА\"}\r\n        </span>\r\n      </div>\r\n\r\n      <div className=\"flex-1 overflow-y-auto px-5 py-4 flex flex-col gap-5\">\r\n        {/* Карточки метрик */}\r\n        <div className=\"grid grid-cols-2 md:grid-cols-4 gap-3\">\r\n          <StatCard label=\"Всего событий\" value={stats.totalEvents} />\r\n          <StatCard label=\"Диалогов\" value={stats.totalConversations} />\r\n          <StatCard label=\"Среднее настроение\" value={`${(stats.avgMood * 100).toFixed(0)}%`} sub=\"0% = плохо, 100% = отлично\" />\r\n          <StatCard label=\"Самый активный\" value={stats.mostActiveAgent} />\r\n        </div>\r\n\r\n        {/* События по типам */}\r\n        <div>\r\n          <h3 className=\"font-mono text-[10px] tracking-widest uppercase mb-3\" style={{ color: \"var(--muted-foreground)\" }}>\r\n            {\"СОБЫТИЯ ПО ТИПАМ\"}\r\n          </h3>\r\n          <BarChart\r\n            items={stats.eventsByType.map((e) => ({\r\n              label: eventTypeLabels[e.type] || e.type,\r\n              value: e.count,\r\n              color: eventTypeColors[e.type] || \"var(--cyber-glow)\",\r\n            }))}\r\n            maxVal={maxEventCount}\r\n          />\r\n        </div>\r\n\r\n        {/* Распределение настроений */}\r\n        <div>\r\n          <h3 className=\"font-mono text-[10px] tracking-widest uppercase mb-3\" style={{ color: \"var(--muted-foreground)\" }}>\r\n            {\"РАСПРЕДЕЛЕНИЕ НАСТРОЕНИЙ\"}\r\n          </h3>\r\n          <BarChart\r\n            items={stats.moodDistribution.map((m) => ({\r\n              label: MOOD_CONFIG[m.mood].label,\r\n              value: m.count,\r\n              color: MOOD_CONFIG[m.mood].color,\r\n            }))}\r\n            maxVal={maxMoodCount}\r\n          />\r\n        </div>\r\n\r\n        {/* Самая сильная связь */}\r\n        <div>\r\n          <h3 className=\"font-mono text-[10px] tracking-widest uppercase mb-2\" style={{ color: \"var(--muted-foreground)\" }}>\r\n            {\"САМАЯ СИЛЬНАЯ СВЯЗЬ\"}\r\n          </h3>\r\n          <div\r\n            className=\"flex items-center justify-between px-4 py-3 rounded-sm\"\r\n            style={{\r\n              backgroundColor: \"rgba(229,195,75,0.04)\",\r\n              border: \"1px solid rgba(229,195,75,0.15)\",\r\n            }}\r\n          >\r\n            <div className=\"flex items-center gap-3\">\r\n              <span className=\"font-mono text-sm\" style={{ color: \"var(--foreground)\" }}>\r\n                {stats.topRelationship.from}\r\n              </span>\r\n              <span className=\"font-mono text-xs\" style={{ color: \"var(--muted-foreground)\" }}>{\"<->\"}</span>\r\n              <span className=\"font-mono text-sm\" style={{ color: \"var(--foreground)\" }}>\r\n                {stats.topRelationship.to}\r\n              </span>\r\n            </div>\r\n            <span className=\"font-mono text-sm font-bold\" style={{ color: topRelationshipColor }}>\r\n              {stats.topRelationship.sentiment > 0 ? \"+\" : \"\"}{(stats.topRelationship.sentiment * 100).toFixed(0)}%\r\n            </span>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n","\"use client\"\r\n\r\nexport function MessagesPanel() {\r\n  return (\r\n    <div\r\n      className=\"flex h-full w-full items-center justify-center\"\r\n      style={{ backgroundColor: \"var(--cyber-surface)\" }}\r\n    >\r\n      <div className=\"flex flex-col items-center gap-4\">\r\n        <div\r\n          className=\"h-20 w-20 rounded-sm border flex items-center justify-center\"\r\n          style={{\r\n            borderColor: \"rgba(229,195,75,0.2)\",\r\n            boxShadow: \"0 0 20px rgba(229,195,75,0.05)\",\r\n          }}\r\n        >\r\n          <svg width=\"32\" height=\"32\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"var(--cyber-glow)\" strokeWidth=\"1\" opacity=\"0.4\">\r\n            <path d=\"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z\" />\r\n          </svg>\r\n        </div>\r\n        <p className=\"font-mono text-sm tracking-[0.2em] uppercase\" style={{ color: \"var(--cyber-glow)\", opacity: 0.4 }}>\r\n          {\"СООБЩЕНИЯ // СКОРО\"}\r\n        </p>\r\n        <p className=\"font-mono text-xs\" style={{ color: \"var(--muted-foreground)\" }}>\r\n          {\"Функция в разработке\"}\r\n        </p>\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n"],"names":[],"mappings":"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"}